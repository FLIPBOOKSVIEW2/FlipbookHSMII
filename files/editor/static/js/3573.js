"use strict";(self.webpackChunkeditor_cli=self.webpackChunkeditor_cli||[]).push([[3573],{43573:function(t,e,i){i.r(e),i.d(e,{default:function(){return u}});var a=i(18023),n=i(87632),o=i(2137),s={name:"UploadActionImg",components:{MutiUploadList:n.default},props:["index","isLogo","actionMaxSideSize","editWechatObj"],data(){return{}},mounted(){},computed:{imageUploadOpts(){return new o.C({multiple:!1,accept:this.acceptImageType.map((t=>`.${t}`)).join(",")})},acceptImageType:function(){return this.$store.getters.acceptImageType},item:function(){return this.$store.getters.currentSelectedItem},actionList:function(){return this.item.actionList}},methods:{changeImg:function(t){this.$emit("changeImg",t)},showImgPanel:function(){let t="addWechat";this.isLogo&&(t+="-logo"),this.$store.commit(a.V_g,{isShow:!0,changeActionType:t,replaceActionObj:this.editWechatObj?this.editWechatObj:this.actionList[this.index].addWechat,itemIndex:this.$store.state.workSpace.currentSelectedItemIndex,actionListIndex:this.index}),this.$store.commit(a.$8l,{menu:"image"}),this.$store.commit(a.xZf,{firstType:"image",secType:"upload-image"})},addNewPopImg:function(t){this.$emit("addNewPopImg",t)},cancel(){this.$refs.uploadButton.removeTask()}}},c=i(1001),d=(0,c.Z)(s,(function(){var t=this,e=t._self._c;return e("el-row",{staticClass:"UploadActionImg",attrs:{type:"flex",align:"middle"}},[e("div",{staticClass:"add-popupImg"},[e("MutiUploadList",{ref:"uploadButton",attrs:{"upload-title":"上传微信二维码","file-dialog-opts":t.imageUploadOpts,imageMaxSide:t.actionMaxSideSize},on:{"upload-success":t.changeImg,"upload-before":t.addNewPopImg}})],1),e("div",{staticClass:"editor_v2_white_btn",on:{click:t.showImgPanel}},[t._v("素材库")])])}),[],!1,null,"7c384389",null).exports,l=(i(24118),i(66546)),p=(i(31008),i(69244)),r={name:"AddWechat",components:{MutiUploadList:n.default,UploadActionImg:d,EditIcon:()=>i.e(8717).then(i.bind(i,18717)),CloseIcon:()=>i.e(1118).then(i.bind(i,41118)),ReplaceIcon:()=>i.e(730).then(i.bind(i,30730)),UploadIcon:()=>i.e(8454).then(i.bind(i,98454)),NoImageIcon:()=>i.e(1592).then(i.bind(i,61592)),LogoCloseIcon:()=>i.e(1092).then(i.bind(i,1092))},props:["index"],data(){return{isEnterPopUpImgEdit:!1,curFastAddIndex:"",editWechatObj:{},curPopupImgEditIndex:0,MAX_IMAGE_LONG_SIZE:240}},mounted(){l.Q.$on(l.Y.UPDATE_WECHAT_IMAGE,this.applyUserImage)},beforeDestroy(){l.Q.$off(l.Y.UPDATE_WECHAT_IMAGE,this.applyUserImage)},computed:{replaceActionObj:function(){return this.$store.state.actionEventsListPanel.replaceActionObj},actionListIndex:function(){return this.$store.getters.actionListIndex},acceptImageType:function(){return this.$store.getters.acceptImageType},item:function(){return this.$store.getters.currentSelectedItem},actionList:function(){return this.item.actionList},logoUrl:function(){return this.item.actionList[this.index].addWechat.logoObj.url},changeActionType:function(){return this.$store.state.actionEventsListPanel.changeActionType},imageUploadOpts(){return new o.C({multiple:!1,accept:this.acceptImageType.map((t=>`.${t}`)).join(",")})}},methods:{saveBeforePage:function(){this.$store.commit(a.CjF)},saveUndo:function(){this.$store.commit(a.N23,{canUndo:!0})},changeInputList:function(t,e){},loadImg:function(t){let e=new Image;e.src=t.url,e.complete?t.isLoadingThumb=!1:e.onload=()=>{t.isLoadingThumb=!1}},updateWechatAction(t,e){const i=this.actionList[this.index];switch(i.addWechat||(i.addWechat=new p.$O),t){case"img":i.addWechat.imgList.splice(0,1,e);break;case"logo":i.addWechat.logoObj=e}},applyUserImage(t){const{width:e,height:i,url:n}=t;if(this.$store.commit(a.V_g,{isShow:!1}),Math.max(e,i)>this.MAX_IMAGE_LONG_SIZE){const t=this.$i18n.t("Message_js.imageDimensionsError",{idealWidth:this.MAX_IMAGE_LONG_SIZE,idealHeight:this.MAX_IMAGE_LONG_SIZE,width:e,height:i});this.$message.warning(t)}else this.saveBeforePage(),this.updateWechatAction("img",new p.Vf({url:n,isLoadingThumb:!1})),this.saveUndo()},changeImg:function(t,e,i){const a={width:t.width,height:t.height,url:t.url};this.applyUserImage(a)},deletePopImgListItem:function(t,e){this.saveBeforePage(),this.actionList[t].addWechat.imgList[e].url||this.$refs.UploadActionImg.cancel(),this.actionList[t].addWechat=new p.$O,this.saveUndo()},enterPopUpImgEditCase:function(t,e){this.saveBeforePage(),this.isEnterPopUpImgEdit=!0,this.editWechatObj=JSON.parse(JSON.stringify(t))},changeLogoImg:function(t){this.saveBeforePage(),this.updateWechatAction("logo",new p.FU({url:t.url})),this.saveUndo()},deleteLogo:function(){this.saveBeforePage(),this.updateWechatAction("logo",new p.FU({})),this.saveUndo()},popUpImgEditConfirm:function(t){},popUpImgEditCancel:function(){this.isEnterPopUpImgEdit=!1},replaceImg(){this.$refs.uploadButton.selectFile()}}},g=(0,c.Z)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"AddWechat"},[e("div",{staticClass:"action-group item-group group"},[e("UploadActionImg",{ref:"UploadActionImg",attrs:{index:t.index,actionMaxSideSize:t.MAX_IMAGE_LONG_SIZE},on:{changeImg:function(e){return t.changeImg(e,t.index,!1)}}}),t.isEnterPopUpImgEdit?e("div",{staticClass:"popupImg-edit-panel"},[e("div",{staticClass:"popupImg-edit-panel_title"},[t._v(" "+t._s(t.$t("rightPanel.action_editImg"))+" ")]),e("div",{staticClass:"popupImg-edit-close-btn",on:{click:function(e){return e.stopPropagation(),t.popUpImgEditCancel.apply(null,arguments)}}},[e("el-icon",[e("CloseIcon",{tag:"component"})],1)],1),e("div",{staticClass:"popupImg-edit-bg",on:{click:t.replaceImg}},[t.actionList[t.index].addWechat.imgList[0]&&t.actionList[t.index].addWechat.imgList[0].url?e("img",{staticClass:"wechatImg",attrs:{src:t.actionList[t.index].addWechat.imgList[0].url}}):t._e(),e("div",{staticClass:"uploadImg"},[e("el-row",{staticStyle:{height:"100%"},attrs:{type:"flex",align:"middle",justify:"center"}},[e("el-icon",{staticStyle:{"margin-right":"5px"}},[e("ReplaceIcon",{tag:"component"})],1),e("span",{directives:[{name:"t",rawName:"v-t",value:"rightPanel.action_changePopupImg",expression:"'rightPanel.action_changePopupImg'"}]})],1),e("MutiUploadList",{ref:"uploadButton",attrs:{"file-dialog-opts":t.imageUploadOpts,imageMaxSide:t.MAX_IMAGE_LONG_SIZE},on:{"upload-success":function(e){return t.changeImg(e,t.index,!0)}}})],1)]),e("div",{staticClass:"iframe-input-box"},[e("el-input",{staticClass:"props_el-input-h34",attrs:{placeholder:t.$t("rightPanel.action_popupImgTitle")+"（"+t.$t("addWechat.optional")+"）"},on:{change:function(e){return t.changeInputList(t.index,"popupImg")},blur:t.saveUndo,keydown:function(t){t.stopPropagation()}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.popUpImgEditConfirm(t.index)}},model:{value:t.actionList[t.index].addWechat.imgList[0].title,callback:function(e){t.$set(t.actionList[t.index].addWechat.imgList[0],"title",e)},expression:"actionList[index].addWechat.imgList[0].title"}})],1),e("div",{staticClass:"iframe-input-box"},[e("el-input",{staticClass:"props_el-input-h34",attrs:{placeholder:t.$t("rightPanel.action_popupImgDesc")+"（"+t.$t("addWechat.optional")+"）"},on:{change:function(e){return t.changeInputList(t.index,"popupImg")},blur:t.saveUndo,keydown:function(t){t.stopPropagation()}},model:{value:t.actionList[t.index].addWechat.imgList[0].desc,callback:function(e){t.$set(t.actionList[t.index].addWechat.imgList[0],"desc",e)},expression:"actionList[index].addWechat.imgList[0].desc"}})],1),e("div",{staticClass:"iframe-input-box"},[e("el-row",{staticClass:"logo-panel",attrs:{type:"flex",align:"middle"}},[e("el-row",{staticClass:"logo-img",attrs:{type:"flex",align:"middle",justify:"center"}},[t.actionList[t.index].addWechat.logoObj.url?t._e():e("el-icon",{attrs:{size:20}},[e("NoImageIcon",{tag:"component"})],1),t.actionList[t.index].addWechat.logoObj.url?e("img",{staticClass:"wechatImg",attrs:{src:t.actionList[t.index].addWechat.logoObj.url}}):t._e(),e("div",{staticClass:"delete_logo",on:{click:function(e){return t.deleteLogo(t.index)}}},[t.actionList[t.index].addWechat.logoObj.url?e("el-icon",{attrs:{size:16}},[e("LogoCloseIcon",{tag:"component"})],1):t._e()],1)],1),e("MutiUploadList",{attrs:{"file-dialog-opts":t.imageUploadOpts,imageMaxSide:150},on:{"upload-success":t.changeLogoImg},scopedSlots:t._u([{key:"title",fn:function(){return[e("el-row",{attrs:{type:"flex",align:"middle"}},[e("el-icon",{staticStyle:{"margin-right":"5px"},attrs:{size:12}},[e(t.actionList[t.index].addWechat.url?"ReplaceIcon":"UploadIcon",{tag:"component"})],1),t._v(" "+t._s(t.actionList[t.index].addWechat.url?"替换LOGO":"上传LOGO")+" ")],1)]},proxy:!0}],null,!1,3348082912)})],1)],1)]):t._e(),t.actionList[t.index].addWechat.imgList.length?e("ul",{staticClass:"popupImg-list"},t._l(t.actionList[t.index].addWechat.imgList,(function(i,a){return e("li",{key:"img"+a,staticClass:"popupImg-item"},[e("el-row",{staticClass:"edit_box",attrs:{type:"flex",align:"middle"}},[i.isLoadingThumb?t._e():e("div",{staticClass:"edit_btn",on:{click:function(e){return e.stopPropagation(),t.enterPopUpImgEditCase(t.actionList[t.index].addWechat,t.index,a)}}},[e("el-icon",{attrs:{size:10}},[e("EditIcon",{tag:"component"})],1)],1),e("div",{staticClass:"delete_btn",on:{click:function(e){return e.stopPropagation(),t.deletePopImgListItem(t.index,a)}}},[e("el-icon",{attrs:{size:10}},[e("CloseIcon",{tag:"component"})],1)],1)]),i.url?e("img",{staticClass:"wechatImg",attrs:{src:i.url}}):t._e(),i.isLoadingThumb?e("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],staticClass:"popupImg-loading"}):t._e()],1)})),0):t._e()],1)])}),[],!1,null,"1b1e67f7",null),u=g.exports}}]);