"use strict";(self.webpackChunkeditor_cli=self.webpackChunkeditor_cli||[]).push([[2547],{94782:function(e,t,s){s.d(t,{Z:function(){return a}});var i={name:"EditorSecondMenuTabs",props:{tabs:{type:Array,default:function(){return[]}},height:{type:Number,default:32},selectedTabType:{type:String,default:""}},data(){return{}},computed:{tabHeight(){return this.height},tabSelectedType(){return this.selectedTabType}},methods:{selectTab(e){this.tabSelectedType!==e.type&&(e.disable?this.$emit("tab-disabled-selected",e):this.$emit("tab-selected",e))}}},a=(0,s(1001).Z)(i,(function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"editor_sec_menu_tabs",style:{height:e.tabHeight+"px"}},[t("el-row",{staticClass:"tabs_list",attrs:{type:"flex",align:"middle",justify:"center"}},[e._l(e.tabs,(function(s){return[s.isShow?e._e():t("span",{key:s.type,staticClass:"tab",class:{tab_selected:s.type===e.tabSelectedType,tab_not_allow:s.disable},on:{click:function(t){return e.selectTab(s)}}},[e._v(" "+e._s(s.tKey?e.$t(s.tKey):s.label)+" "),e._t(`slot-${s.type}`)],2)]}))],2)],1)}),[],!1,null,"2db8a61d",null).exports},52547:function(e,t,s){s.r(t),s.d(t,{default:function(){return ue}});s(57658);var i=s(99519),a=s(58866),l=s(6859),o=s(63037),n=s(94782),r=(s(73181),s(18023)),p=s(97873),c=(s(21703),s(68939)),h=s(46896);class d{constructor(e){(0,p.Z)(this,"title",""),(0,p.Z)(this,"description",""),(0,p.Z)(this,"keyword",""),(0,p.Z)(this,"showCommercial",!1),(0,p.Z)(this,"id",0),(0,p.Z)(this,"isCollect",!1),(0,p.Z)(this,"isFavorite","0"),(0,p.Z)(this,"templateOrigin","h5"),(0,p.Z)(this,"isTeamTemplate",!1),(0,p.Z)(this,"isMineTemplate",!1),(0,p.Z)(this,"isSystemTemplate",!0),this.id=e.id??0,this.title=e.title??"模板",this.description=e.description??"",this.keyword=e.keyword??""}}var m=s(66741);class u extends d{constructor(e,t="h5"){super(e),(0,p.Z)(this,"ownerId",451276),(0,p.Z)(this,"authorId",451276),(0,p.Z)(this,"bookId",0),(0,p.Z)(this,"metaDescription",null),(0,p.Z)(this,"title",""),(0,p.Z)(this,"description",""),(0,p.Z)(this,"keyword",""),(0,p.Z)(this,"newTime",1697708407487),(0,p.Z)(this,"updateTime",1697709649518),(0,p.Z)(this,"lang","en"),(0,p.Z)(this,"firstId",33),(0,p.Z)(this,"ragenCode",1),(0,p.Z)(this,"linkName","sbbf"),(0,p.Z)(this,"linkPath","https://t.flipbuilder.com/templates/sbbf/index.html"),(0,p.Z)(this,"pageWidth",540),(0,p.Z)(this,"pageHeight",779),(0,p.Z)(this,"pages",10),(0,p.Z)(this,"space",46.9),(0,p.Z)(this,"realViews",0),(0,p.Z)(this,"realUses",0),(0,p.Z)(this,"adminScore","0.000"),(0,p.Z)(this,"uName",null),(0,p.Z)(this,"uLinkName",null),(0,p.Z)(this,"accountLogo",null),(0,p.Z)(this,"thumbnail",""),(0,p.Z)(this,"detailUrl",""),(0,p.Z)(this,"seoTitle","医疗健康疫情防控手册制作"),(0,p.Z)(this,"wcScore",0),(0,p.Z)(this,"keywords",""),(0,p.Z)(this,"id",18552771),(0,p.Z)(this,"views",322),(0,p.Z)(this,"showVersionIcon",!0),(0,p.Z)(this,"uses",16),(0,p.Z)(this,"isCollect",!1),(0,p.Z)(this,"rangeName",""),(0,p.Z)(this,"templateOrigin","h5"),(0,p.Z)(this,"fetchingDetails",!1),this.templateOrigin=t,"h5"===t&&this.updateRangeName(e),"yz"===t&&(e.rangeName=(0,m.Gq)(Number(e.ragenCode))),Object.assign(this,e),void 0===e.id&&e.templateId&&(this.id=e.templateId)}updateRangeName(e){switch(Number(e.ragenCode)){case 1:default:e.rangeName="FREE";break;case 2:e.rangeName="PRO";break;case 3:e.rangeName="PLATINUM";break;case 4:e.rangeName="DIAMOND";break;case 5:e.rangeName="ENTERPRISE"}}}class g{constructor(e){(0,p.Z)(this,"id",9),(0,p.Z)(this,"name","Menus"),(0,p.Z)(this,"langLabel","en"),(0,p.Z)(this,"urlName","menus"),Object.assign(this,e)}}class f{constructor(e){(0,p.Z)(this,"id",1),(0,p.Z)(this,"name","Free"),Object.assign(this,e),this.name=(0,h.Z)(e.name)}}class w{constructor(e){(0,p.Z)(this,"id",0),(0,p.Z)(this,"teamId",20489889),(0,p.Z)(this,"userId",8),(0,p.Z)(this,"name",""),(0,p.Z)(this,"roleId",1),(0,p.Z)(this,"status",1),(0,p.Z)(this,"newTime","1662003559198"),(0,p.Z)(this,"updateTime","1662003559198"),(0,p.Z)(this,"uEmail","11@11.com"),(0,p.Z)(this,"mobilePhone",null),(0,p.Z)(this,"uLink","eyfk"),(0,p.Z)(this,"uName","广东软件园广州万彩信息技术有限公司测试测测测下测测测"),(0,p.Z)(this,"accountLogo","accountlogo.png"),(0,p.Z)(this,"logoUrl","https://test2.yunzhan365.com/eyfk/accountlogo.png"),Object.assign(this,e)}}var T=s(46450),y=s(24118),v=s(11721),_=s(83469);class C extends d{get formatTotalTime(){if(!this.totalTime)return"00:00";const e=y.Z.getFormatTime(Number(this.totalTime));return e.minute+":"+e.second}get isTeam(){return this.isTeamTemplate}get showVersionIcon(){return!(!this.isCollect&&!this.isSystemTemplate)&&v.Z.state.userData.uType<Number(this.range)}get templateInfo(){return[...this.keywords.replace(/(,|;)/g," ").split(" ").slice(0,5)]}get thumbnail(){return this.isTeamTemplate?`${v.Z.getters.resourceHost}/${this.teamOwnerLink}/Team/${this.teamId}/Template/${this.tLink}/files/shot.jpg`:(this.isMineTemplate&&(this.uLink=v.Z.state.userData.uLink),`${v.Z.getters.resourceHost}/${this.uLink}/Template/${this.tLink}/files/shot.jpg`)}constructor(e,t="xz"){super(e),(0,p.Z)(this,"id",""),(0,p.Z)(this,"localId",(0,_.Z)("_template")),(0,p.Z)(this,"title",""),(0,p.Z)(this,"description",""),(0,p.Z)(this,"keywords",""),(0,p.Z)(this,"secondarycatId","1"),(0,p.Z)(this,"tLink","ozsx"),(0,p.Z)(this,"uLink","xz_hwtx"),(0,p.Z)(this,"newTime",""),(0,p.Z)(this,"updateTime",""),(0,p.Z)(this,"width","736"),(0,p.Z)(this,"height","414"),(0,p.Z)(this,"unit","px"),(0,p.Z)(this,"views","278"),(0,p.Z)(this,"uses","41"),(0,p.Z)(this,"price","0"),(0,p.Z)(this,"range","0"),(0,p.Z)(this,"type","1"),(0,p.Z)(this,"sizeType","1"),(0,p.Z)(this,"totalTime",""),(0,p.Z)(this,"status","1"),(0,p.Z)(this,"isPublish","1"),(0,p.Z)(this,"hasAudio","0"),(0,p.Z)(this,"isHot","0"),(0,p.Z)(this,"isFavorite","0"),(0,p.Z)(this,"secondarycatTitle",""),(0,p.Z)(this,"teamId","0"),(0,p.Z)(this,"videoId",910),(0,p.Z)(this,"isCommercial","1"),(0,p.Z)(this,"vLink","cyjg"),(0,p.Z)(this,"showCommercial",!0),(0,p.Z)(this,"isSystemTemplate",!1),(0,p.Z)(this,"isTeamTemplate",!1),(0,p.Z)(this,"isMineTemplate",!1),(0,p.Z)(this,"uName",""),(0,p.Z)(this,"teamOwnerId",""),(0,p.Z)(this,"teamOwnerLink",""),(0,p.Z)(this,"templateOrigin","xz"),Object.assign(this,e),this.keywords&&(this.keyword=this.keywords)}}class b extends T.m{constructor(e=0,t=20,s="h5"){super(e,t,s),(0,p.Z)(this,"cancelHandle",{system:null,collect:null,favorite:null,viewcount:null,collectTemplate:null,details:null,mine:null,team:null,member:null})}fetchSystemTemplate(e,t){const{req:s,cancel:i}=this.baseFetch(e,t);return this.cancelHandle.system=i,s.then((e=>e.map((e=>(e.isSystemTemplate=!0,e))))).finally((()=>{this.cancelHandle.system=null}))}fetchCollectTemplate(e,t){return c.Z.post(t,e,{cancelToken:new c.Z.CancelToken((e=>{this.cancelHandle.collect=e}))}).then((e=>{const{data:t}=e;if("ok"===t.code.toLowerCase())return t.data;throw Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message)})).finally((()=>{this.cancelHandle.collect=null}))}baseFetch(e,t){const s=Object.assign({},e,this.pagingParams);let i=null;return{req:c.Z.post(t,s,{cancelToken:new c.Z.CancelToken((e=>{i=e}))}).then((e=>{const{data:t}=e,{status:s,code:i,teamOwnerLink:a,teamOwnerId:l}=t;if(1===Number(s)||"ok"===i.toLowerCase()){this.pageIndex++;return(t.templates||t.data.list).map((e=>"xz"===this.project?(a&&(e.teamOwnerLink=a),l&&(e.teamOwnerId=l),new C(e,this.project)):new u(e,this.project)))}throw Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message);return[]})),cancel:i}}fetchFavoriteTemplates(e,t){const{req:s,cancel:i}=this.baseFetch(e,t);return this.cancelHandle.favorite=i,s.then((e=>(e.forEach((e=>{e.isCollect=!0,e.isFavorite="1",e.isSystemTemplate=!0})),e))).finally((()=>{this.cancelHandle.favorite=null}))}fetchMineTemplates(e,t){const{req:s,cancel:i}=this.baseFetch(e,t);return this.cancelHandle.mine=i,s.then((e=>e.map((e=>(e.showVersionIcon=!1,e.isMineTemplate=!0,e))))).finally((()=>{this.cancelHandle.mine=null}))}fetchTeamTemplates(e,t){const{req:s,cancel:i}=this.baseFetch(e,t);return this.cancelHandle.team=i,s.then((e=>e.map((e=>(e.isTeamTemplate=!0,e))))).finally((()=>{this.cancelHandle.team=null}))}getH5TemplateClass(e){return c.Z.get(e).then((e=>{const{data:t}=e;if("ok"===t.code.toLowerCase()){const{categoryInfo:e,levelInfo:s}=t.data;return{categoryInfo:e.map((e=>new g(e))),levelInfo:Object.values(s).map((e=>new f(e)))}}throw Error(t.msg)}))}addViewCount(e,t){return c.Z.post(t,e,{cancelToken:new c.Z.CancelToken((e=>{this.cancelHandle.viewcount=e}))}).then((e=>{const{data:t}=e;if("ok"===t.code.toLowerCase())return t;throw Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message)})).finally((()=>{this.cancelHandle.viewcount=null}))}collectTemplate(e,t){return c.Z.post(t,e,{cancelToken:new c.Z.CancelToken((e=>{this.cancelHandle.collectTemplate=e}))}).then((e=>{const{data:t}=e,{status:s,code:i}=t;if(1===Number(s)||"ok"===i.toLowerCase())return t;throw Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message)})).finally((()=>{this.cancelHandle.collectTemplate=null}))}fetchTemplateDetails(e,t){return c.Z.post(t,e,{cancelToken:new c.Z.CancelToken((e=>{this.cancelHandle.details=e}))}).then((e=>{const{data:t}=e;if("ok"===t.code.toLowerCase())return t.data;throw"NOT_POWER"===e.data.code?Error("NOT_POWER"):Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message)})).finally((()=>{this.cancelHandle.details=null}))}fetchTeamMember(e,t){return c.Z.post(t,e,{cancelToken:new c.Z.CancelToken((e=>{this.cancelHandle.member=e}))}).then((e=>{const{data:t}=e;if("ok"===t.code.toLowerCase())return t.data.list.map((e=>new w(e)));throw Error(t.msg)})).catch((e=>{if("canceled"!==e.message)throw Error(e.message)})).finally((()=>{this.cancelHandle.member=null}))}}var k=s(61632),x=s(48589),I={name:"IconEye"},Z=s(1001),$=(0,Z.Z)(I,(function(){var e=this._self._c;return e("svg",{attrs:{viewBox:"0 0 14 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M7 0C3.61666 0 0.777779 2.35713 0 5.5C0.777779 8.64287 3.61666 11 7 11C10.3833 11 13.2222 8.64287 14 5.5C13.2222 2.35713 10.3833 0 7 0ZM7.03888 9.03572C5.09444 9.03572 3.53888 7.46428 3.53888 5.5C3.53888 3.53572 5.09444 1.96428 7.03888 1.96428C8.98332 1.96428 10.5389 3.53572 10.5389 5.5C10.5389 7.46428 8.94444 9.03572 7.03888 9.03572Z",fill:"currentColor"}}),e("path",{attrs:{d:"M5.17236 5.5C5.17236 5.74247 5.21964 5.98258 5.31149 6.20659C5.40335 6.43061 5.53798 6.63416 5.70771 6.80562C5.87743 6.97708 6.07893 7.11308 6.30068 7.20588C6.52244 7.29867 6.76012 7.34643 7.00014 7.34643C7.24017 7.34643 7.47785 7.29867 7.6996 7.20588C7.92136 7.11308 8.12285 6.97708 8.29258 6.80562C8.4623 6.63416 8.59694 6.43061 8.68879 6.20659C8.78064 5.98258 8.82792 5.74247 8.82792 5.5C8.82792 5.25752 8.78064 5.01742 8.68879 4.7934C8.59694 4.56938 8.4623 4.36583 8.29258 4.19437C8.12285 4.02291 7.92136 3.88691 7.6996 3.79412C7.47785 3.70132 7.24017 3.65356 7.00014 3.65356C6.76012 3.65356 6.52244 3.70132 6.30068 3.79412C6.07893 3.88691 5.87743 4.02291 5.70771 4.19437C5.53798 4.36583 5.40335 4.56938 5.31149 4.7934C5.21964 5.01742 5.17236 5.25752 5.17236 5.5Z",fill:"currentColor"}})])}),[],!1,null,null,null).exports,P={name:"IconEye"},S=(0,Z.Z)(P,(function(){var e=this._self._c;return e("svg",{attrs:{viewBox:"0 0 14 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M10.1254 0C8.86281 0 7.69133 0.856894 7.00088 1.48934C6.30955 0.856894 5.13894 0 3.87458 0C1.48517 0 0 1.44585 0 3.77294C0 5.73902 1.78921 7.3084 1.79622 7.31361L6.45851 11.779C6.60133 11.9208 6.79322 12 7 12C7.20678 12 7.3978 11.9208 7.53799 11.7825L12.2099 7.31535C12.6296 6.91605 14 5.48238 14 3.77381C14.0009 1.44585 12.5157 0 10.1254 0Z",fill:"currentColor"}})])}),[],!1,null,null,null).exports,M=s(70072),L=s(7986),D={name:"EditorTemplateList",data(){return{popoverTemplate:null,enterTimer:null}},props:{selectedTabType:{type:String,default:"recommend"},templateList:{type:Array,require:!0},rowHeight:{type:Number,default:190},thumbFit:{type:String,default:"contain"},showTemplateCollectButton:{type:Boolean,default:!1}},computed:{templates(){return this.templateList},isFlipPro:function(){return this.$store.getters.isFlipPro},isH5Pro:function(){return this.$store.getters.isH5Pro}},methods:{formatInfo(e){let t="";t="number"==typeof e.newTime?e.newTimeFormat:e.updateTime||e.newTime;const{name:s,author:i,keyword:a,isPixabay:l,pixabayUrl:o,pixabayFrom:n,id:r,resourceInfo:p,localId:c,isFavorite:h,totalTime:d}=e;let m=(0,L.A)(d);return new L.k({newTime:t,totalTime:m,name:s,author:i,keywords:e.resourceInfo,isPixabay:l,pixabayUrl:o,pixabayFrom:n,type:"resource",id:r||c,isFavorite:h})},popoverShow(e){this.popoverVisible=!0,this.popoverTemplate=e},popoverHide(e){e.localId===this.popoverTemplate.localId&&(this.popoverTemplate=null)},getTemplateDetails(e){this.$emit("template-details",e)},previewTemplate(e){this.$emit("template-preview",e)},collectTemplate(e){this.$emit("template-collect",e)},mouseEnterTemplate(e){this.$refs[`VersionRef_${e.id}`]&&this.$refs[`VersionRef_${e.id}`][0].show(),"xz"===e.templateOrigin&&(this.enterTimer&&clearTimeout(this.enterTimer),this.enterTimer=setTimeout((()=>{this.$emit("template-preview",e)}),500))},mouseLeaveTemplate(e){this.$refs[`VersionRef_${e.id}`]&&this.$refs[`VersionRef_${e.id}`][0].hide(),"xz"===e.templateOrigin&&(clearTimeout(this.enterTimer),this.$emit("template-preview",null))}},filters:{pageFilter(e){return Number(e)<10?"0"+Number(e)+"P":e+"P"}},components:{IconEye:$,IconLike:S,IconStar:M.Z,ImageSkeletonVue:k.default,ResourceCardNew:x.Z}},H=(0,Z.Z)(D,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"editor_template_list"},e._l(e.templates,(function(s,i){return t("div",{key:s.id,staticClass:"template",style:{height:e.rowHeight+"px"},on:{mouseenter:function(t){return e.mouseEnterTemplate(s)},mouseleave:function(t){return e.mouseLeaveTemplate(s)}}},[t("ImageSkeletonVue",{attrs:{src:s.thumbnail,fit:e.thumbFit},nativeOn:{click:function(t){return e.getTemplateDetails(s)}}}),t("el-row",{staticClass:"template_icons",attrs:{type:"flex",align:"start",justify:"space-between"}},[t("el-row",{staticClass:"template_top_icons",attrs:{type:"flex",align:"middle",justify:"space-between"}},["xz"===s.templateOrigin?[t("el-row",{staticClass:"xz_template_top_icons",attrs:{type:"flex",align:"middle",justify:s.showVersionIcon?"space-between":"end"}},[s.showVersionIcon?t("icon-version",{ref:`VersionRef_${s.id}`,refInFor:!0,staticClass:"template_info_icon",attrs:{"level-id":s.range,"custom-style":{position:"relative",left:"-6px",top:"-8px"},isBindParent:!1}}):e._e(),e.isFlipPro?e._e():t("el-popover",{attrs:{"append-to":".editor_template_list",placement:i%2==0?"bottom":"bottom-end",width:"230","visible-arrow":!1,"popper-class":"resource_popover"},on:{show:function(t){return e.popoverShow(s)},hide:function(t){return e.popoverHide(s)}}},[t("el-row",{staticClass:"template_more template_info_icon",class:{moreVisible:e.popoverTemplate&&e.popoverTemplate.localId===s.localId},attrs:{slot:"reference",type:"flex",justify:"center",align:"middle"},slot:"reference"},[t("i",{staticClass:"el-icon-more"})]),t("ResourceCardNew",{attrs:{resourceInfo:e.formatInfo(s),"show-collect-btn":e.showTemplateCollectButton},on:{"add-like":function(t){return e.collectTemplate(s)}}},[t("el-row",{staticClass:"e_pb_15"})],1)],1)],1)]:[s.showVersionIcon?t("icon-version",{ref:`VersionRef_${s.id}`,refInFor:!0,staticClass:"template_info_icon",attrs:{"level-id":s.ragenCode,"custom-style":{position:"relative",left:0,top:0}}}):e._e(),t("el-row",{staticClass:"template_preview",attrs:{type:"flex",align:"middle",justify:"center"}},[t("el-tooltip",{attrs:{enterable:!1,content:e.$t("tipsMsg.preview"),placement:"top","open-delay":800}},[t("el-row",{staticClass:"template_label template_icon template_preview_icon template_info_icon",attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return t.stopPropagation(),e.previewTemplate(s)}}},[t("el-icon",[t("IconEye")],1)],1)],1),"mine"!==e.selectedTabType?t("el-tooltip",{attrs:{enterable:!1,content:s.isCollect?e.$t("tipsMsg.collected"):e.$t("tipsMsg.collect"),placement:"top","open-delay":800}},[e.showTemplateCollectButton?t("el-row",{staticClass:"template_label template_icon template_like_icon template_info_icon",class:{collected:s.isCollect},attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return t.stopPropagation(),e.collectTemplate(s)}}},[t("IconLike")],1):e._e()],1):e._e()],1)]],2),"xz"===s.templateOrigin?[1!==parseFloat(s.isCommercial)||e.isH5Pro?e._e():t("icon-commercial",{staticClass:"icon-commercial template_info_icon",attrs:{placement:"bottom-left","custom-style":{position:"relative",left:0,top:0}}})]:[t("el-row",{staticClass:"template_label template_page",attrs:{type:"flex",align:"middle"}},[t("span",[e._v(e._s(e._f("pageFilter")(s.pages)))])])]],2),t("el-row",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticClass:"template_loading",class:{eventAuto:s.fetchingDetails},nativeOn:{click:function(e){e.stopPropagation()}}})],1)})),0)}),[],!1,null,"1ec054b4",null).exports,E=s(81023),O={bind(e,t){let s=0,i=0;e.__vueSetInterval__=setInterval((function(){const a=document.defaultView.getComputedStyle(e);!s===a.width&&i===a.height||"function"==typeof t.value&&t.value({width:a.width,height:a.height}),s=a.width,i=a.height}),300)},unbind(e){clearInterval(e.__vueSetInterval__)}},V=s(22541),B=s(7130);var N=s(51485),F=s(50708),A=s(82958);const j=function(){let e=v.Z.state.yzPageModule.bookConfig.pageNumberCaption+"",t=v.Z.state.yzPageModule.bookConfig.totalPageCount;";"===e.substr(e.length-1,1)&&(e=e.substr(0,e.length-1));let s=e.split(";"),i=[];for(let e=0;e<s.length;e++){if(""===s[e]||void 0===s[e])continue;let a=s[e].split(":");if(a[0])if(a[1]||(a[1]=""),a[1].indexOf("+")>-1){let e=a[0],s=(e.indexOf("-"),e.split("-")),l=s[0],o=s[1],n=parseInt(l),r=o?parseInt(o):t,p=U(a[1]);for(let e=n;e<=r;e++){let t=(e-n)*p.addition+p.startPage,s="";0===p.type&&(s=t+""),1===p.type&&(s=Y(t)),2===p.type&&(s=Y(t).toLowerCase()),i[e]=z(p.page,s)}}else if(isNaN(a[0])){if(a[0].indexOf("-")>-1){let e=a[0],s=(e.indexOf("-"),e.split("-")),l=s[0],o=s[1],n=parseInt(l),r=o?parseInt(o):t;for(let e=n;e<=r;e++)i[e]=void 0===a[1]?"":a[1]}}else{i[parseInt(a[0])]=void 0===a[1]?"":a[1]}}return i};function z(...e){if(0===e.length)return"";if(1===e.length)return e[0];let t=function(e){return"number"==typeof e&&-1===Number(e).toString().indexOf(".")},s=function(e){return"number"==typeof e},i=function(e){return"boolean"==typeof e},a=function(e){return"object"==typeof e},l=e[0],o=function(e,...t){if(0===e.length||0===t.length)return[];let s=[],i=e.toString(),a=0;for(;a<i.length;){let e=!1;for(let l=0;l<t.length;l++){let o=t[l];if(i.substr(a,o.length)===o){s.push(o),a+=o.length,e=!0;break}}e||a++}return s}(l,"%s","%d","%f","%b","%o");for(let n=1;n<e.length;n++){let r=e[n],p=o[n-1];"%s"===p&&(l="string"==typeof r?l.replace("%s",r):l.replace("%s","")),"%d"===p&&(isNaN(r)&&(r=0),l=t(r)?l.replace("%d",r+""):l.replace("%d","")),"%f"===p&&(isNaN(r)&&(r=0),l=s(r)?l.replace("%f",r+""):l.replace("%f","")),"%b"===p&&(r=!!r,l=i(r)?l.replace("%b",r+""):l.replace("%b","")),"%o"===p&&(l=a(r)?l.replace("%o",Instance.JSON(r)):l.replace("%o",""))}return l}function U(e){let t={page:"%s",startPage:1,type:0,addition:1};if(e.indexOf("{")>-1){let s=e.indexOf("{"),i=e.indexOf("}")+1,a=e.substring(s,i);t.page=e.replace(a,"%s"),a.indexOf("N+")>-1&&(t.type=0),a.indexOf("R+")>-1&&(t.type=1),a.indexOf("r+")>-1&&(t.type=2);let l=function(e,t,s){if(void 0===t||void 0===s)return"";let i=e.length,a=e.indexOf(t);if(-1===a)return"";a+=t.length;let l=e.substring(a,i).indexOf(s);if(-1===l)return"";l+=a;return e.substring(a,l)}(a,"+","}");t.startPage=""===l?1:parseInt(l)}else{let s=e.split("+")[0],i=e.split("+")[1];t.startPage=""===s?1:parseInt(s),i&&(t.addition=parseInt(i))}return t}function Y(e){if(isNaN(e))return"";let t=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"]],s="",i=0;for(let a=0,l=1e3;a<3;a++,l/=10)i=Math.floor(e%l/(l/10)),s+=t[2-a][i];return s}const W=function(e){let t=v.Z.state.yzPageModule.bookConfig.pageNumberCaption;if(""===t||void 0===t)return e;e=parseInt(e);let s=j();if(void 0===s[e])return e;return s[e]};var R=s(88531),G={name:"saveAsTemplate",data(){return{deviceTabs:[{name:"previewBook2022_09_14.text1",value:1,isShow:!0},{name:"previewBook2022_09_14.text2",value:2,isShow:!0},{name:"previewBook2022_09_14.text3",value:3,isShow:!0}],previewBoxWidth:"",previewBoxHeight:"",iframeWidth:"",iframeHeight:"",deviceId:1,showCodeBox:!1,qrcode:"",userInfo:{}}},props:["showPreviewBook","template","draftUrl","userSelfLink","isShowBottom","bookId"],watch:{qrcodeUrl:function(e){e&&this.createQRCode()}},created:function(){},mounted:function(){this.getConfig(),this.createQRCode(),this.isShowBottom&&this.getUserInfo()},updated:function(){},computed:{isYZEditTemplate:function(){return this.$store.state.tempData.isYZEditTemplate},isH5Pro:function(){return this.$store.getters.isH5Pro},isYZPro:function(){return this.$store.getters.isYZPro},linkName:function(){return this.isYZEditTemplate?this.$t("previewBook2022_09_14.text7"):this.$t("previewBook2022_09_14.text6")},qrcodeUrl:function(){if(void 0!==this.template)return this.template.detailUrl;if(this.userSelfLink){if(this.isYZEditTemplate)return"";{let e=this.draftUrl;return e.match(/http(s)?/)||(e=`https://${e.replace("//","")}`),e=e.replace("index.html",""),e=`${e}?${(new Date).getTime()}`,e}}return""},previewPath:function(){if(void 0!==this.template)return this.template.linkPath;{let e=this.userSelfLink.replace("book.","");const t=this.$store.state.yzPageModule.yzCoopQuery;return t.cptoken&&(e=`${e}?cptoken=${t.cptoken}`),e}},previewTitle:function(){return void 0!==this.template?this.template.title:""},currentIndex:function(){return this.$store.state.pagePanel.currentIndex},currentPreviewPage:function(){if(void 0!==this.template)return W(1);if(this.$store.state.doublePage.isDoubleEdit&&this.currentIndex){let e=2*(this.currentIndex+1)-2;return W(e)}return W(this.currentIndex+1)},failPage(){const e=this.$store.state.pagePanel.pages;if(0===e.length)return"";const t=[];return e.forEach(((e,s)=>{"fail"===e.create2AiStauts&&t.push(s+1)})),0===t.length?"":t.join(",")}},methods:{createQRCode:function(){let e=s(74798);this.$nextTick((()=>{this.qrcode=new e({content:this.qrcodeUrl,width:120,height:120,padding:0,color:"#000000",background:"#ffffff",ecl:"M"}).svg()}))},getConfig(){this.previewBoxWidth=Math.round(.8*window.innerWidth)+"px",this.previewBoxHeight=Math.round(.8*window.innerHeight)+60+20+"px",this.switchingDevices(this.deviceId)},switchingDevices:function(e){switch(this.deviceId=e,this.deviceId){case 1:this.iframeWidth="100%",this.iframeHeight="100%";break;case 2:setTimeout((()=>{this.iframeWidth=Math.floor(.885*this.$refs.phone.offsetWidth)+"px",this.iframeHeight=Math.floor(.86*this.$refs.phone.offsetHeight)+"px"}));break;case 3:setTimeout((()=>{this.iframeWidth=Math.floor(.84*this.$refs.pad.offsetWidth)+"px",this.iframeHeight=Math.floor(.88*this.$refs.pad.offsetHeight)+"px"}))}},copyLink(){const{copy:e}=(0,N.V)();e(this.qrcodeUrl).then((()=>{this.$message.success(this.$t("previewBook2022_09_14.text9"))}))},colseLight(){this.$emit("update:showPreviewBook",!1)},toEditPage(){window.location.href=`${this.$store.getters.host}/editorv2/${this.bookId}`},toDashBoard(){let e="";this.isH5Pro&&(e=`${this.$store.getters.host}/dashboard/publications`),this.isYZPro&&(e=`${store.getters.host}/manage/flips/files/0`),e&&window.open(e,"_blank")},openQuestion:function(){const{toggle:e}=(0,R.createPopup)("fd6HqB1B",{height:520,width:710,hidden:{registered_email:this.userInfo.uEmail??"unknown",plan:this.userInfo.hasOwnProperty("uType")?this.getVersionName(this.userInfo.uType):"unknown",book_link:this.userSelfLink},onSubmit:e=>{},onClose:()=>{this.isShowQuestionaire=!1},autoClose:3e3});e()},getUserInfo:function(){var e;(e=`${this.$store.getters.host}/api/user/get-user`,c.Z.post(e,{}).then((e=>{if("ok"===e.data.code.toLowerCase()){const t=e.data.data;return new B.m(t)}throw Error(e.data.msg)}))).then((e=>{this.userInfo=e})).catch((e=>{}))},getVersionName:function(e){const t={0:"Free",2:"Pro",4:"Platinum",5:"Enterprise"};return t[e=Number(e)]??t[0]}},components:{Lightbox:A.default,SliderTab:F.Z},directives:{}},X=(0,Z.Z)(G,(function(){var e=this,t=e._self._c;return t("Lightbox",{attrs:{isShow:e.showPreviewBook,isAutoWidth:!0,hasPadding:!1,hasNoBorderBigRadius:!0,showOutsideClose:!0,showClose:!0,closeCallBack:e.colseLight},on:{"update:isShow":function(t){e.showPreviewBook=t},"update:is-show":function(t){e.showPreviewBook=t}}},[t("div",{staticClass:"previewBox",style:{width:e.previewBoxWidth,height:e.previewBoxHeight}},[t("el-row",{staticClass:"preview-nav",attrs:{type:"flex",align:"middle",justify:"center"}},[this.previewTitle?t("div",{staticClass:"title"},[e._v(" "+e._s(this.previewTitle)+" ")]):e._e(),t("el-row",{staticClass:"device",class:{h5device:e.isH5Pro},attrs:{type:"flex",align:"middle"}},[t("el-row",{staticClass:"computer",class:{active:1===e.deviceId},attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return e.switchingDevices(1)}}},[t("i",{staticClass:"icon"}),t("span",[e._v(e._s(e.$t("previewBook2022_09_14.text1")))])]),t("el-row",{staticClass:"phone",class:{active:2===e.deviceId},attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return e.switchingDevices(2)}}},[t("i",{staticClass:"icon"}),t("span",[e._v(e._s(e.$t("previewBook2022_09_14.text2")))])]),t("el-row",{staticClass:"pad",class:{active:3===e.deviceId},attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return e.switchingDevices(3)}}},[t("i",{staticClass:"icon"}),t("span",[e._v(e._s(e.$t("previewBook2022_09_14.text3")))])])],1),e.qrcodeUrl?t("div",{staticClass:"codePreview"},[t("el-popover",{attrs:{placement:"bottom",width:"350",trigger:"hover","popper-class":"preview_qr_code"}},[t("el-row",{staticClass:"codeBox",attrs:{type:"flex",align:"middle",justify:"center"}},[t("div",{staticClass:"code",attrs:{id:"code"},domProps:{innerHTML:e._s(e.qrcode)}}),t("el-row",{staticClass:"link",attrs:{type:"flex",align:"middle",justify:"center"}},[t("div",{staticClass:"linkName"},[e._v(e._s(e.linkName))]),t("el-row",{staticClass:"linkUrl",attrs:{type:"flex",align:"middle",justify:"space-around"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.qrcodeUrl,expression:"qrcodeUrl"}],ref:"input",attrs:{readonly:"readonly"},domProps:{value:e.qrcodeUrl},on:{input:function(t){t.target.composing||(e.qrcodeUrl=t.target.value)}}}),t("span",{on:{click:e.copyLink}},[e._v(" "+e._s(e.$t("previewBook2022_09_14.text5"))+" ")])])],1)],1),t("el-row",{staticClass:"textTips",attrs:{slot:"reference",type:"flex",align:"middle",justify:"center"},slot:"reference"},[t("i",{staticClass:"icon"}),t("span",[e._v(e._s(e.$t("previewBook2022_09_14.text4")))])])],1)],1):e._e(),t("div",{staticClass:"scanningCode"})],1),t("div",{staticClass:"iframeBox",style:{width:"100%",height:e.isShowBottom?"calc(100% - 120px)":"calc(100% - 60px)"}},[t("img",{directives:[{name:"show",rawName:"v-show",value:2===e.deviceId,expression:"deviceId === 2"}],ref:"phone",attrs:{src:s(26096)}}),t("img",{directives:[{name:"show",rawName:"v-show",value:3===e.deviceId,expression:"deviceId === 3"}],ref:"pad",attrs:{src:s(59468)}}),t("iframe",{staticClass:"previewBookWrap",style:{width:e.iframeWidth,height:e.iframeHeight},attrs:{allowfullscreen:"allowfullscreen",src:`${e.previewPath}${1===e.deviceId?`#p=${e.currentPreviewPage}`:(-1===e.previewPath.indexOf("?")?"?":"&")+"phone=true&maxwidthtosmallmode=0&maxheighttosmallmode=0"+`#p=${e.currentPreviewPage}`}`,frameborder:"0"}})]),e.failPage?t("div",{staticClass:"page_fail flex justify-end"},[e._v(" "+e._s(e.$t("AIEbookGenerator.PageFailedTips",{PAGE:e.failPage}))+" ")]):e._e(),e.isShowBottom?t("div",{staticClass:"flex items-center justify-between mt-4"},[t("div",{staticClass:"editor_v2_white_btn",on:{click:e.openQuestion}},[e._v(" "+e._s(e.$t("AIEbookGenerator.HelpImprove"))+" ")]),t("div",{staticClass:"flex items-center gap-x-5"},[t("div",{staticClass:"editor_v2_white_btn",on:{click:e.toDashBoard}},[e._v(" "+e._s(e.$t("AIEbookGenerator.BackDashboard"))+" ")]),t("div",{staticClass:"editor_v2_main_btn",on:{click:e.toEditPage}},[e._v(" "+e._s(e.$t("AIEbookGenerator.EditNow"))+" ")])])]):e._e()],1)])}),[],!1,null,"1d3d3799",null).exports,q=s(26648),K=s(86534),Q=s(25986),J={name:"ApplyTemplateTips",data(){return{applyMode:3,applyModeOption:[{mode:1,label:this.$i18n.t("ApplyTemplateTips_vue.text9")},{mode:2,label:this.$i18n.t("ApplyTemplateTips_vue.text10")},{mode:3,label:this.$i18n.t("ApplyTemplateTips_vue.text11")}],applyModeOptionYZ:[{mode:1,label:this.$i18n.t("ApplyTemplateTips_vue.text15")},{mode:2,label:this.$i18n.t("ApplyTemplateTips_vue.text16")},{mode:3,label:this.$i18n.t("ApplyTemplateTips_vue.text17")}],applyModeOptionH5:[{mode:1,label:this.$i18n.t("ApplyTemplateTips_vue.text23")},{mode:2,label:this.$i18n.t("ApplyTemplateTips_vue.text24")},{mode:3,label:this.$i18n.t("ApplyTemplateTips_vue.text25")}],updateWH:!1,replaceBGM:!0,applyTempSize:!0}},props:{confirmCallback:{type:Function,desc:"点击确定按钮回调",default:function(){return()=>{}}},hideReplaceBgm:{type:Boolean,desc:"是否隐藏替换背景音乐选项",default:!1},templateInfo:{type:Object,desc:"模板详情信息",default:function(){return{}}}},created:function(){},mounted:function(){this.isYZPro?this.applyModeOption=this.applyModeOptionYZ:this.isH5Pro&&(this.applyModeOption=this.applyModeOptionH5)},updated:function(){},computed:{isShowApplyTemplateTips:{get:function(){return this.$store.state.scenePanel.isShowApplyTemplateTips},set:function(e){this.$store.state.scenePanel.isShowApplyTemplateTips=e}},isXZPro:function(){return this.$store.getters.isXZPro},isYZPro(){return this.$store.getters.isYZPro},isH5Pro(){return this.$store.getters.isH5Pro},bookData(){return this.$store.state.bookData},isCreateFromTemplate:function(){return this.$store.state.topHeader.isCreateFromTemplate}},methods:{confirmFn:function(){if(this.confirmCallback){if((this.isYZPro||this.isH5Pro)&&(this.isCreatedForScratch||this.isCreateFromTemplate))return(0,K.MZ)();this.confirmCallback({applyTemplateMode:this.applyMode,replaceBGM:!(!this.isXZPro||this.hideReplaceBgm)&&this.replaceBGM,updateWH:this.updateWH,applyTempSize:this.applyTempSize})}}},components:{Lightbox:Q.default,InfoTipsIcon:()=>s.e(3352).then(s.bind(s,83352))},directives:{}},ee=(0,Z.Z)(J,(function(){var e=this,t=e._self._c;return e.isShowApplyTemplateTips?t("Lightbox",{attrs:{isShow:e.isShowApplyTemplateTips,title:e.$t("ApplyTemplateTips_vue.text1"),modalType:"Confirm",showConfirm:!0,customStyle:{"max-width":"360px"},"custom-class":"applyTemplateTips",confirmCallBack:e.confirmFn},on:{"update:isShow":function(t){e.isShowApplyTemplateTips=t},"update:is-show":function(t){e.isShowApplyTemplateTips=t}}},[t("el-row",{staticClass:"apply-tips-wrap",attrs:{display:"flex",align:"middle"}},[t("el-row",{staticClass:"apply-warning",domProps:{innerHTML:e._s(e.$t("ApplyTemplateTips_vue.applyTemplateTips"))}}),t("el-row",{staticClass:"apply-radios"},[t("el-radio-group",{staticClass:"apply-radio-group",model:{value:e.applyMode,callback:function(t){e.applyMode=t},expression:"applyMode"}},e._l(e.applyModeOption,(function(s){return t("el-radio",{key:s.mode,attrs:{"data-v":"v2",label:s.mode}},[e._v(" "+e._s(s.label)+" "),(e.isH5Pro||e.isXZPro)&&1===s.mode&&1===e.applyMode?t("el-row",{staticClass:"fit_size",attrs:{type:"flex",align:"middle"}},[t("el-checkbox",{attrs:{"data-v":"v2"},model:{value:e.applyTempSize,callback:function(t){e.applyTempSize=t},expression:"applyTempSize"}}),t("div",{staticStyle:{"max-width":"260px"}},[e._v(" "+e._s(e.$t("ApplyTemplateTips_vue.fitSize"))+" ")]),e.templateInfo.pageWidth?t("el-tooltip",{attrs:{placement:"top","open-delay":800},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticStyle:{"max-width":"300px"}},[e._v(" "+e._s(e.$t("ApplyTemplateTips_vue.fitSizeTips",{canvasSize:`${e.bookData.pageOriginWidth}x${e.bookData.pageOriginHeight}`,tempSize:`${e.isH5Pro?e.templateInfo.pageWidth:e.templateInfo.width}x${e.isH5Pro?e.templateInfo.pageHeight:e.templateInfo.height}`}))+" ")])]},proxy:!0}],null,!0)},[t("el-icon",{staticStyle:{"margin-left":"-4px",color:"#bbb"}},[t("InfoTipsIcon",{tag:"component"})],1)],1):e._e()],1):e._e()],1)})),1)],1),e.isXZPro&&!e.hideReplaceBgm?t("el-row",{staticClass:"apply-select-wrap",attrs:{type:"flex",align:"middle"}},[t("el-checkbox",{attrs:{"data-v":"v2"},model:{value:e.replaceBGM,callback:function(t){e.replaceBGM=t},expression:"replaceBGM"}},[e._v(e._s(e.$t("ApplyTemplateTips_vue.text3")))])],1):e._e()],1)],1):e._e()}),[],!1,null,"5c0d13f1",null).exports,te={name:"EditorTempalteDetails",props:{isFetchingDetails:{type:Boolean,default:!0},templateDetails:{type:Object,require:!0}},data(){return{show:!1,pagesWaitToAdd:[],pageConfig:[],selectedPages:[]}},computed:{emptyMsg(){return this.$i18n.t("EditorTemplateDetailsList.noTemplateData")},templateTitle(){return this.templateDetails.title},isShowApplyTemplateTips:{get:function(){return this.$store.state.scenePanel.isShowApplyTemplateTips},set:function(e){this.$store.state.scenePanel.isShowApplyTemplateTips=e}},showAddSelectedPage(){return this.selectedPages.length>0&&this.selectedPages.length<=this.pageConfig.length}},watch:{templateDetails(){this.pageConfig=this.templateDetails?this.templateDetails.pageConfig??[]:[]}},mounted(){this.$nextTick((()=>{this.show=!0}))},methods:{selectPage(e,t){if(e.preventDefault(),e.target.classList.contains("template_page_add")||e.target.closest(".template_page_add"))return;this.pageConfig[t].isChecked=!this.pageConfig[t].isChecked;const s=this.pageConfig[t].isChecked,i=this.selectedPages.indexOf(t);s&&-1===i&&this.selectedPages.push(t),!s&&i>-1&&this.selectedPages.splice(i,1)},clearSelectedPages(){this.selectedPages=[],this.pageConfig.forEach((e=>{e.isChecked=!1}))},addSingle(e){this.addTemplate([e])},addSelected(){this.addTemplate(this.selectedPages.sort(((e,t)=>e-t)))},addAll(){this.addTemplate(Array.from({length:this.pageConfig.length},((e,t)=>t)))},addTemplate(e){this.isShowApplyTemplateTips=!0,this.pagesWaitToAdd=e},changeTemplate(e){this.clearSelectedPages(),this.$emit("add-pages-to-book",this.pagesWaitToAdd,e)}},filters:{pageIndexFilter(e){return Number(e)+1<10?"0"+Number(e+1):Number(e)+1}},components:{ImageSkeletonVue:q.Z,EditorVirtualList:V.Z,ApplyTemplateTips:ee},directives:{}},se=(0,Z.Z)(te,(function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"editor_template_details sec_menu_flex_1",attrs:{type:"flex"}},[t("el-row",{staticClass:"e_plr_15 e_pb_15"},[t("el-row",{staticClass:"editor_v2_white_btn",nativeOn:{click:function(t){return e.addAll.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("YZTemplateAll.applyAllPage",{length:e.pageConfig.length}))+" ")])],1),t("el-row",{staticClass:"tempate_pages sec_menu_flex_1",attrs:{type:"flex"}},[t("EditorVirtualList",{attrs:{col:2,"row-h":200,total:e.pageConfig.length,"use-virtual":!1,"virtual-id":"detail_scroll"}},[t("el-row",{staticClass:"e_plr_15"},[e.show&&!e.isFetchingDetails?t("div",{staticClass:"editor_template_details_box"},e._l(e.pageConfig,(function(s,i){return t("el-row",{key:i,staticClass:"template_page",class:{selected:s.isChecked},nativeOn:{click:function(t){return e.selectPage(t,i)}}},[t("ImageSkeletonVue",{attrs:{src:s.t,fit:"contain",scrollContainer:"#detail_scroll"}}),t("el-row",{staticClass:"template_page_mask"},[t("el-row",{staticClass:"template_page_select_btn"},[t("el-checkbox",{attrs:{size:"large"},on:{change:function(t){return e.selectPage(t,i)}},model:{value:s.isChecked,callback:function(t){e.$set(s,"isChecked",t)},expression:"page.isChecked"}})],1),t("el-row",{staticClass:"template_page_add",attrs:{type:"flex",align:"middle",justify:"center"},nativeOn:{click:function(t){return e.addSingle(i)}}},[t("i",{staticClass:"el-icon-plus"})]),t("el-row",{staticClass:"template_page_number"},[e._v(" "+e._s(e._f("pageIndexFilter")(i))+" ")])],1),t("el-row",{staticClass:"template_page_selected_mask"},[t("el-row",{staticClass:"template_page_select_btn"},[t("el-checkbox",{attrs:{size:"large"},on:{change:function(t){return e.selectPage(t,i)}},model:{value:s.isChecked,callback:function(t){e.$set(s,"isChecked",t)},expression:"page.isChecked"}})],1)],1)],1)})),1):e._e(),t("el-skeleton",{staticClass:"template_skeleton",attrs:{animated:"",loading:e.isFetchingDetails}},[t("template",{slot:"template"},e._l(20,(function(e){return t("el-skeleton-item",{key:e,staticClass:"template_skeleton_item",attrs:{variant:"image"}})})),1)],2)],1)],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showAddSelectedPage,expression:"showAddSelectedPage"}],staticClass:"template_page_selected",attrs:{type:"flex",justify:"space-between",align:"middle"}},[t("span",[e._v(e._s(e.$t("YZTemplateAll.selectedPage",{length:e.selectedPages.length})))]),t("el-row",{attrs:{type:"flex"}},[t("el-row",{staticClass:"template_cancel",attrs:{type:"flex",justify:"center",align:"middle"},nativeOn:{click:function(t){return e.clearSelectedPages.apply(null,arguments)}}},[e._v(e._s(e.$t("YZTemplateAll.Cancel")))]),t("el-row",{staticClass:"template_confirm",attrs:{type:"flex",justify:"center",align:"middle"},nativeOn:{click:function(t){return e.addSelected.apply(null,arguments)}}},[e._v(e._s(e.$t("YZTemplateAll.Add")))])],1)],1)],1),t("ApplyTemplateTips",{attrs:{confirmCallback:e.changeTemplate,templateInfo:e.templateDetails}})],1)}),[],!1,null,"6bda1449",null),ie=se.exports,ae=s(25243),le=(s(69773),s(66546)),oe=s(13638),ne=s(95944),re=s(36208),pe=s(78096),ce=s(11373),he=(0,Z.Z)({},(function(){var e=this._self._c;return e("svg",{attrs:{width:"72",height:"84",viewBox:"0 0 72 84",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M1 42H72V84H1V42Z",fill:"#D7EFFF"}}),e("rect",{attrs:{x:"0.5",y:"22.5",width:"49",height:"61",fill:"#0099FF",stroke:"black"}}),e("rect",{attrs:{x:"7.5",y:"14.5",width:"49",height:"61",fill:"white",stroke:"black"}}),e("path",{attrs:{d:"M15 22H36V24H15V22Z",fill:"#D9D9D9"}}),e("path",{attrs:{d:"M15 28H49V68H15V28Z",fill:"#D9D9D9"}}),e("path",{attrs:{d:"M62.8571 0H49.1429L40 9.14286V22.8571L49.1429 32H62.8571L72 22.8571V9.14286L62.8571 0Z",fill:"#FDA12D"}}),e("path",{attrs:{d:"M48 16.4997C50 17.4997 52 20.9997 52 20.9997V25.4997L44 17.4997C44 17.4997 46 15.4997 48 16.4997Z",fill:"white"}}),e("path",{attrs:{d:"M62 9.5C62 8.67157 62.6716 8 63.5 8C64.3284 8 65 8.67157 65 9.5V15H62V9.5Z",fill:"white"}}),e("path",{attrs:{d:"M58 7.5C58 6.67157 58.6716 6 59.5 6C60.3284 6 61 6.67157 61 7.5V15H58V7.5Z",fill:"white"}}),e("path",{attrs:{d:"M54 5.5C54 4.67157 54.6716 4 55.5 4C56.3284 4 57 4.67157 57 5.5V15H54V5.5Z",fill:"white"}}),e("path",{attrs:{d:"M50 8.5C50 7.67157 50.6716 7 51.5 7C52.3284 7 53 7.67157 53 8.5V15H50V8.5Z",fill:"white"}}),e("path",{attrs:{d:"M50 15H65V20.5C65 24.6421 61.6421 28 57.5 28C53.3579 28 50 24.6421 50 20.5V15Z",fill:"white"}}),e("path",{attrs:{d:"M50.8722 18.2026C50.8722 18.2026 52.3897 18.4527 53.4522 19.4715C54.5146 20.4902 55.1278 22.377 55.1278 22.377",stroke:"black","stroke-linecap":"round"}})])}),[],!1,null,null,null).exports,de={name:"EditorTemplatePanel",data(){return{templateMenuData:l.C9,levelList:[],teamMemberId:-1,teamMemberList:[],templateLevelType:0,categoryList:[],templateCateType:0,showTemplateDetails:!1,templateDetailInfo:null,showPreviewBook:!1,previewTemplateInfo:null,templateUtils:new b,searchValue:"",templateList:[],virtualStartIndex:-1,virtualEndIndex:-1,noMoreData:!1,isLoadingMore:!1,isGettingMember:!1,isGettingClass:!1,isIniting:!1,isSearchMode:!1,isFetchingDetails:!1,templateTeamId:0}},computed:{project(){return this.$store.state.project},isYZPro(){return this.$store.getters.isYZPro},isVisitorMode(){return this.$store.state.pagePanel.isVisitorMode},isV2Version(){return this.$store.state.yzPageModule.isV2Version},isXZPro(){return this.$store.getters.isXZPro},isH5Pro(){return this.$store.getters.isH5Pro},selectedTabType(){return this.$store.state.menuPanel.secMenuNavType.template},host:function(){return this.$store.getters.host},notShowSelect(){return"mine"===this.selectedTabType},notShowCategorySelect(){return"recommend"!==this.selectedTabType},userData:function(){return this.$store.state.userData},teamId(){return this.$store.state.userData.teamId},templateVisibleList(){return-1!==this.virtualStartIndex&&-1!==this.virtualEndIndex?this.templateList.slice(this.virtualStartIndex,this.virtualEndIndex):this.templateList},resourceDomainName:function(){if(this.isH5Pro){if(this.isDev||this.isTestEnv)return"//t.flipbuilder.com";return window._webConfig.s3_user_host.includes("//")?window._webConfig.s3_user_host:"//"+window._webConfig.s3_user_host}return""},computedLevelList(){return[].concat([{name:this.$i18n.t("YZSecondeMenuForTemplate.text2"),id:0}],this.levelList)},computedTeamMember(){return[].concat([{id:-1,teamId:-1,uLink:"",uName:this.$i18n.t("YZSecondeMenuForTemplate.text3"),tKey:"YZSecondeMenuForTemplate.text3"}],this.teamMemberList)},computedCategoryList(){return[].concat([{name:this.$i18n.t("YZSecondeMenuForTemplate.text1"),id:0,tKey:"YZSecondeMenuForTemplate.text1"}],this.categoryList)},isDoubleEdit:function(){return this.$store.state.doublePage.isDoubleEdit},isCreateFromTemplate:function(){return this.$store.state.topHeader.isCreateFromTemplate}},watch:{showPreviewBook(e){e||(this.previewTemplateInfo=null)},selectedTabType(){this.templateLevelType=0}},mounted(){if(this.getTemplateTeamId(),this.templateUtils=new b(this.isXZPro?0:1,20,this.$store.state.project),(this.isXZPro||this.isYZPro&&0!==this.teamId)&&(~this.templateMenuData.children.findIndex((e=>e.type===l.B6.type))||this.templateMenuData.children.push(l.B6),this.isCreateFromTemplate&&this.isYZPro&&0===this.templateTeamId)){const e=this.templateMenuData.children.findIndex((e=>e.type===l.B6.type));-1!==e&&this.templateMenuData.children.splice(e,1)}this.fetchClass(),this.navChange({type:this.selectedTabType}),le.Q.$on(le.Y.UPDATE_MINE_TEMPLATE_LIST,(()=>{"mine"===this.selectedTabType&&(this.isIniting=!0,this.resetData(),this.fetchMineTemplates())}))},beforeDestroy(){le.Q.$off(le.Y.UPDATE_MINE_TEMPLATE_LIST)},activated(){},methods:{close(){this.$store.commit(r.$8l,{menu:"scene"})},templateSearch(e){this.searchValue=e,this.$store.commit(r.F$g,{newSearchValue:e,type:"templateSearchValue"}),this.navChange({type:this.selectedTabType})},navChange(e){if(!this.isIniting){if(this.$store.commit(r.xZf,{firstType:"template",secType:e.type}),this.$refs.virtualList){const e=this.$refs.virtualList.$refs.scroll_container;e&&e.scrollTo({top:0})}this.resetData(),this.isIniting=!0,this.wayToFetchTemplate(e.type)}},wayToFetchTemplate(e){"recommend"===e?this.fetchSystemTemplates():"liked"===e?this.fetchFavoriteTemplates():"mine"===e?this.fetchMineTemplates():"team"===e&&(0===this.teamMemberList.length&&this.fetchTeamMember(),this.fetchTeamTemplates())},teamMemberChange(){this.navChange({type:this.selectedTabType})},levelTypeChange(){this.navChange({type:this.selectedTabType})},cateTypeChange(){this.navChange({type:this.selectedTabType})},async loadMoreData(){this.noMoreData||this.isLoadingMore||this.isIniting||(this.isLoadingMore=!0,this.wayToFetchTemplate(this.selectedTabType))},resetData(){this.noMoreData=!1,this.isLoadingMore=!1,this.templateUtils.reset(),this.templateList=[]},fetchClass(){this.isGettingClass=!0,this.templateUtils.getH5TemplateClass(`${this.host}/api/template/constant-data`).then((e=>{let{categoryInfo:t,levelInfo:s}=e;if(t=t.filter((e=>this.isH5Pro?"en"===e.langLabel:e)),this.categoryList.push(...t),this.isYZPro)if(this.isV2Version){const e=this.$store.state.yzPageModule.isEnjoySmooth;s=s.filter((t=>e?t.id>=7||1===t.id||-1===t.id:(t.id>=7||1===t.id||-1===t.id)&&8!==t.id))}else s=s.filter((e=>e.id<=5||-1===e.id));this.levelList.push(...s)})).catch((e=>{this.$message.error(e.message)})).finally((()=>{setTimeout((()=>{this.isGettingClass=!1}),500)}))},async fetchSystemTemplates(){const e=Object.assign({sort:"newTime:desc",teamId:0},this.searchValue?{keyword:this.searchValue}:{},this.templateCateType?{firstId:this.templateCateType}:{},this.templateLevelType?{ragenCode:this.templateLevelType}:{}),t=await this.templateUtils.fetchSystemTemplate(e,`${this.host}/api/template/website-page`).catch((e=>{this.$message.error(e.message)}));t&&(await this.getCollect(t),this.addTemplate(t)),this.isLoadingMore=!1,this.isIniting=!1},async fetchMineTemplates(){const e=Object.assign(this.searchValue?{keyword:this.searchValue}:{},{teamId:0}),t=await this.templateUtils.fetchMineTemplates(e,`${this.host}/api/template/template-page`).catch((e=>{this.$message.error(e.message)}));t&&this.addTemplate(t),this.isLoadingMore=!1,this.isIniting=!1},async fetchFavoriteTemplates(){const e=Object.assign({tabId:2,teamId:0},this.searchValue?{keyword:this.searchValue}:{},this.templateLevelType?{ragenCode:this.templateLevelType}:{}),t=await this.templateUtils.fetchFavoriteTemplates(e,`${this.host}/api/template/template-page`).catch((e=>{this.$message.error(e.message)}));t&&this.addTemplate(t),this.isLoadingMore=!1,this.isIniting=!1},async fetchTeamTemplates(){const e=Object.assign({tabId:1},this.searchValue?{keyword:this.searchValue}:{},-1!==this.teamMemberId?{authorId:this.teamMemberId}:{});this.isCreateFromTemplate&&this.isYZPro&&(e.teamId=this.templateTeamId);const t=await this.templateUtils.fetchTeamTemplates(e,`${this.host}/api/template/template-page`).catch((e=>{this.$message.error(e.message)}));t&&this.addTemplate(t),this.isLoadingMore=!1,this.isIniting=!1},async fetchTeamMember(){this.isGettingMember=!0;let e={};this.isCreateFromTemplate&&this.isYZPro&&(e.teamId=this.templateTeamId),await this.templateUtils.fetchTeamMember(e,`${this.$store.getters.host}/api/team/get-team-member`).then((e=>{e&&this.teamMemberList.push(...e)})).catch((e=>{this.$message.error(e.message)})),this.isGettingMember=!1},getCollect(e){if(this.isVisitorMode)return;const t={ids:e.reduce(((e,t)=>e+t.id+","),"").slice(0,-1)};return this.templateUtils.fetchCollectTemplate(t,`${this.host}/api/template/check-collection`).then((t=>{t&&t.forEach((t=>{const s=e.find((e=>e.id===t));s&&(s.isCollect=!0)}))})).catch((e=>{}))},addTemplate(e){this.noMoreData=e.length<this.templateUtils.pageSize,this.templateList.push(...e)},visibleRangeChange(e,t){this.virtualEndIndex=t,this.virtualStartIndex=e},async getTemplateDetails(e){if(this.isH5Pro){if(this.isVisitorMode)return void this.$store.commit(r.Gvu,!0);if(this.$store.getters.curUserLevelId<Number(e.ragenCode))return void this.$message({message:this.$i18n.t("YZSecondeMenuForTemplate.UpgradeTip",{version:e.rangeName}),type:"warning",dangerouslyUseHTMLString:!0})}e.fetchingDetails=!0,this.isFetchingDetails=!0,this.showTemplateDetails=!0;const t=Object.assign({tempId:e.id},e.isMineTemplate?{teamId:0}:{}),s=await this.templateUtils.fetchTemplateDetails(t,`${this.$store.getters.host}/api/template/get-temp-page-editor`).catch((t=>{"NOT_POWER"!==t.message?this.$message.error(t.message):this.$message({message:this.$i18n.t("YZSecondeMenuForTemplate.UpgradeTip",{version:e.rangeName}),type:"warning",dangerouslyUseHTMLString:!0})})).finally((()=>{e.fetchingDetails=!1,this.isFetchingDetails=!1}));s&&(s.pageConfig=s.pageConfig.map((e=>({...e,isChecked:!1}))),s.templateResourcePath=s.tLinkPath,this.templateDetailInfo=Object.freeze(s))},exitDetail(){this.showTemplateDetails=!1,this.templateDetailInfo=null},previewTemplate(e){this.previewTemplateInfo=Object.freeze(JSON.parse(JSON.stringify(e))),this.showPreviewBook=!0,"recommend"===this.selectedTabType&&this.addViewCount(e.id)},addViewCount(e){this.templateUtils.addViewCount({templateId:e},`${this.host}/api/template/add-view-count`)},collectTemplate(e){const t={templateId:e.id,type:e.isCollect?2:1};this.templateUtils.collectTemplate(t,`${this.host}/api/template/favorites`).then((t=>{e.isCollect=!e.isCollect,e.isCollect?this.$message.success(this.$i18n.t("collectTemplate.collectSuccess")):this.$message.success(this.$i18n.t("collectTemplate.cancelSuccess"))})).catch((e=>{this.$message.error(this.$i18n.t("collectTemplate.collectFail"))}))},async addPagesToBook(e,t){const s=void 0!==this.templateDetailInfo.pageEditor&&"string"==typeof this.templateDetailInfo.pageEditor;if(1===t.applyTemplateMode&&t.applyTempSize){const{changeW:e,changeH:t}=pe.p.changePageSize({width:this.templateDetailInfo.pageWidth,height:this.templateDetailInfo.pageHeight});this.$store.state.workSpace.canvas.page.originalWidth=e,this.$store.state.workSpace.canvas.page.originalHeight=t,this.$store.state.workSpace.h5ChangeSize.width=this.templateDetailInfo.pageWidth,this.$store.state.workSpace.h5ChangeSize.height=this.templateDetailInfo.pageHeight,this.$store.commit(r.yTP,{pageOriginWidth:this.templateDetailInfo.pageWidth,pageOriginHeight:this.templateDetailInfo.pageHeight})}const i=s?(0,ce.z)(this.templateDetailInfo.pageEditor):await(0,ae.uP)({bookData:this.templateDetailInfo,project:"yz"}),a=[];e.forEach((e=>{a.push(i.pages[e])})),i.pages=a,this.$store.commit(r.F3O,{config:i,resourceHost:this.templateDetailInfo.templateResourcePath,applyTemplateMode:t.applyTemplateMode,replaceBGM:t.replaceBGM,fixKeys:{isSystemTemplate:!0,isCreatedByYZTemplate:!0},ignoreBGIInfo:!1,resourceDomainName:this.resourceDomainName,isHorizontally:!0,bookData:this.templateDetailInfo,templateStartPageIndex:e[0],templatePageIndex:e,isAddTemp:this.isH5Pro||this.isYZPro})},showSaveAsTemplatePanel:function(){if(this.isH5Pro){const e="SAVE_AS_MY_TEMPLATE",t=(0,oe.gu)({type:e});if(!(0,ne.$P)({permissionType:e,uType:this.userData.uType})){const s=(0,ne.KU)({permissionType:e,minLevelId:t});return(0,ne.DB)({permissionType:e,msgText:s}),void re.dE.push("popup_upgrade_panel")}}this.$store.commit(r.K1L,!0)},getTemplateTeamId:function(){if(!this.isCreateFromTemplate||!this.isYZPro)return;const e=new URLSearchParams(window.location.search).get("teamId");e&&(this.templateTeamId=Number.parseInt(e))}},directives:{domResize:O},components:{EditorSecondMenu:i.Z,EditorSecondMenuTitle:a.Z,EditorSecondMenuSearchInput:o.Z,EditorSecondMenuTabs:n.Z,EditorTemplateList:H,EditorVirtualList:V.Z,EditorTempalteDetails:ie,ListFooter:E.Z,PreviewBook:X,EmptyTemplateIcon:he}},me=(0,Z.Z)(de,(function(){var e=this,t=e._self._c;return t("EditorSecondMenu",[e.isDoubleEdit?t("el-row",{staticClass:"double_empty_box"},[t("el-row",{staticClass:"double_editor_template_panel_operate"},[t("EditorSecondMenuTitle",{on:{"close-panel":e.close}}),t("el-row",{staticClass:"empty_double_template_box",attrs:{type:"flex",align:"middle",justify:"center"}},[t("EmptyTemplateIcon",{tag:"component"}),t("div",{staticClass:"empty_double_template_title"},[e._v(e._s(e.$t("addDoublePage_20241022.text10")))])],1)],1)],1):e._e(),t("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.showTemplateDetails&&!e.isDoubleEdit,expression:"!showTemplateDetails && !isDoubleEdit"}],staticClass:"editor_template_panel",attrs:{type:"flex"}},[t("el-row",{staticClass:"editor_template_panel_operate"},[t("el-row",{staticClass:"e_pb_15"},[t("EditorSecondMenuTitle",{attrs:{title:e.$t(e.templateMenuData.tKey)},on:{"close-panel":e.close}})],1),t("el-row",{staticClass:"e_pb_15"},[t("EditorSecondMenuSearchInput",{attrs:{showHistroy:!0,keyword:e.searchValue,isSearchMode:e.isSearchMode,localKey:"templateSearchValue"},on:{"update-search":e.templateSearch,"update:isSearchMode":function(t){e.isSearchMode=t},"update:is-search-mode":function(t){e.isSearchMode=t}}})],1),e.isVisitorMode?e._e():t("el-row",{staticClass:"e_pb_15"},[t("EditorSecondMenuTabs",{attrs:{tabs:e.templateMenuData.children,"selected-tab-type":e.selectedTabType},on:{"tab-selected":e.navChange}})],1),e.notShowSelect?e._e():t("el-row",{staticClass:"e_pb_15"},[t("el-row",{attrs:{type:"flex",justify:"center",align:"middle",gutter:10}},["team"!==e.selectedTabType?[e.notShowCategorySelect?e._e():t("el-col",{attrs:{span:14}},[t("el-skeleton",{staticClass:"select_skeleton",attrs:{animated:"",loading:e.isGettingClass}},[t("template",{slot:"template"},[t("el-skeleton-item",{staticClass:"select_skeleton",attrs:{variant:"text"}})],1),[t("el-select",{attrs:{"data-v":"v2","popper-class":"props-select-input-popper"},on:{change:e.cateTypeChange},model:{value:e.templateCateType,callback:function(t){e.templateCateType=t},expression:"templateCateType"}},e._l(e.computedCategoryList,(function(e){return t("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1)]],2)],1),t("el-col",{attrs:{span:e.notShowCategorySelect?24:10}},[t("el-skeleton",{staticClass:"select_skeleton",attrs:{animated:"",loading:e.isGettingClass}},[t("template",{slot:"template"},[t("el-skeleton-item",{staticClass:"select_skeleton",attrs:{variant:"text"}})],1),[t("el-select",{attrs:{"data-v":"v2","popper-class":"props-select-input-popper"},on:{change:e.levelTypeChange},model:{value:e.templateLevelType,callback:function(t){e.templateLevelType=t},expression:"templateLevelType"}},e._l(e.computedLevelList,(function(e){return t("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1)]],2)],1)]:[t("el-col",{attrs:{span:24}},[t("el-skeleton",{staticClass:"select_skeleton",attrs:{animated:"",loading:e.isGettingMember}},[t("template",{slot:"template"},[t("el-skeleton-item",{staticClass:"select_skeleton",attrs:{variant:"text"}})],1),[t("el-select",{attrs:{"data-v":"v2","popper-class":"props-select-input-popper"},on:{change:e.teamMemberChange},model:{value:e.teamMemberId,callback:function(t){e.teamMemberId=t},expression:"teamMemberId"}},e._l(e.computedTeamMember,(function(s){return t("el-option",{key:s.id,attrs:{label:s.tKey?e.$t(s.tKey):s.uName,value:s.id}})})),1)]],2)],1)]],2)],1)],1),t("el-row",{staticClass:"sec_menu_flex_1",attrs:{type:"flex"}},[t("EditorVirtualList",{ref:"virtualList",attrs:{col:2,rowH:200,total:e.templateList.length},on:{"notify-load-more":e.loadMoreData,"notify-visible-range":e.visibleRangeChange}},[t("el-row",{staticClass:"e_plr_15"},[e.isIniting?e._e():t("EditorTemplateList",{attrs:{"selected-tab-type":e.selectedTabType,"template-list":e.templateVisibleList,"show-template-collect-button":["recommend","liked"].includes(e.selectedTabType)},on:{"template-details":e.getTemplateDetails,"template-preview":e.previewTemplate,"template-collect":e.collectTemplate}}),t("el-skeleton",{staticClass:"template_skeleton",style:{marginTop:e.isLoadingMore?"10px":""},attrs:{animated:"",loading:e.isIniting||e.isLoadingMore}},[t("template",{slot:"template"},e._l(20,(function(e){return t("el-skeleton-item",{key:e,staticClass:"template_skeleton_item",attrs:{variant:"image"}})})),1)],2),t("ListFooter",{attrs:{"loading-more":!1,"no-more":0!==e.templateList.length&&e.noMoreData}},[t("div")])],1),0!==e.templateList.length||e.isIniting?e._e():t("el-row",{staticClass:"empty_data"},[t("i",{staticClass:"icon empty—icon"}),"liked"===e.selectedTabType?t("p",[e._v(" "+e._s(e.$t("previewTemplate.text10"))+" ")]):"mine"===e.selectedTabType?t("div",[t("p",[e._v(e._s(e.$t("previewTemplate.text11")))]),t("div",{staticClass:"save-now btn-green",on:{click:function(t){return t.stopPropagation(),e.showSaveAsTemplatePanel.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("saveAsTemplate.saveAsMyTemplateNow"))+" ")])]):(e.searchValue,t("p",[e._v(" "+e._s(e.$t("previewTemplate.text9"))+" ")]))])],1)],1)],1),e.showTemplateDetails?t("el-row",{staticClass:"editor_template_panel",attrs:{type:"flex"}},[t("el-row",{staticClass:"editor_template_panel_operate"},[t("el-row",{staticClass:"e_pb_15 template_details_title"},[t("EditorSecondMenuTitle",{attrs:{title:e.templateDetailInfo?.title,isShowBack:""},on:{"back-panel":e.exitDetail,"close-panel":e.exitDetail}})],1)],1),t("el-row",{staticClass:"sec_menu_flex_1",attrs:{type:"flex"}},[t("EditorTempalteDetails",{attrs:{isFetchingDetails:e.isFetchingDetails,"template-details":e.templateDetailInfo},on:{"add-pages-to-book":e.addPagesToBook}})],1)],1):e._e(),e.showPreviewBook?t("PreviewBook",{attrs:{showPreviewBook:e.showPreviewBook,template:e.previewTemplateInfo},on:{"update:showPreviewBook":function(t){e.showPreviewBook=t},"update:show-preview-book":function(t){e.showPreviewBook=t}}}):e._e()],1)}),[],!1,null,"73ea211c",null),ue=me.exports},46450:function(e,t,s){s.d(t,{m:function(){return a}});var i=s(97873);class a{constructor(e=0,t=20,s="h5"){(0,i.Z)(this,"originPageIndex",1),(0,i.Z)(this,"pageIndex",1),(0,i.Z)(this,"pageSize",20),(0,i.Z)(this,"project","h5"),(0,i.Z)(this,"cancelHandle",{}),this.pageIndex=e,this.originPageIndex=e,this.pageSize=t,this.project=s}reset(){this.pageIndex=this.originPageIndex,this.cancelOtherPost("")}cancelOtherPost(e){Object.keys(this.cancelHandle).forEach((t=>{t!==e&&this.cancelHandle[t]&&(this.cancelHandle[t](),this.cancelHandle[t]=null)}))}get pagingParams(){return"xz"===this.project?{pageSize:this.pageSize,pageIndex:this.pageIndex}:{size:this.pageSize,current:this.pageIndex}}}},59468:function(e,t,s){e.exports=s.p+"static/img/pad.png"},26096:function(e,t,s){e.exports=s.p+"static/img/phone.png"}}]);