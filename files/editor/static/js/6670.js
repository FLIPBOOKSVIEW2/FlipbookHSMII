"use strict";(self.webpackChunkeditor_cli=self.webpackChunkeditor_cli||[]).push([[6670],{66670:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});i(57658);var n=i(18023),o=i(59659),s=i(7778),a=i(66546),c=i(95944);const r=350;var l=i(94603),m=i(36208),u=i(65687),d={name:"MenuForText",props:["canClick","isMore"],data(){return{}},computed:{headlineItem:function(){return(0,l.LA)("headline")},showSecTextPanel:function(){return this.$store.getters.showSecTextPanel},isFlipPro:function(){return this.$store.getters.isFlipPro},isENLang:function(){return this.$store.getters.isENLang},isOtherLang:function(){return this.$store.getters.isOtherLang}},methods:{addText:async function(){if(this.canClick)if(m.dE.push("menu.text"),this.showSecTextPanel)this.$store.commit(n.$8l,{menu:"text"});else{const t=this.headlineItem;await(0,u.dS)({textToAdd:t}),this.$store.commit(n.t3z,{type:"setting"}),this.$store.commit(n.$8l,{menu:"scene"})}}},directives:{dragTextToAdd:function(t,e,i){const l=i.context.$store;t.onmousedown=function(t){t.preventDefault();let i=e.value.item,m=e.value.textType,u=e.value.stopDrag;if(u)return;let d=l.state.workSpace.viewPercent;l.commit(n.SJ3,{type:m});let h=e.value.height,p=e.value.width,f=t.clientX,g=t.clientY,x=f-p/2,w=g-h/2,T=l.state.workSpace.pageNode;l.commit(n.gzP,{show:!1,height:h,width:p,top:w,left:x,scale:1});let v=l.state.workSpace.canvas.page,S=1,P=i.style.width,k=o.Z.getTextWidthTransform(P);l.commit(n.CiL,P);let y=v.width*k,I=y/p,L=r-f;document.onmousemove=function(t){if(f===t.clientX&&g===t.clientY)return;let e=(t.clientX-f)/L;y>p?(S=1+e,S>I&&(S=I)):(S=1-e,S<I&&(S=I)),t.clientX>r&&(S=I);let i=t.clientX-p*S/2,o=t.clientY-h*S/2;l.commit(n.gzP,{show:!0,top:o,left:i,scale:S})},document.onmouseup=function(t){if(u)return document.onmousemove=null,void(document.onmouseup=null);if(S!==I)return l.commit(n.gzP,{show:!1}),t.stopPropagation(),document.onmousemove=null,void(document.onmouseup=null);let e=l.state.timeline.workSpaceLeft,o=l.state.timeline.workSpaceTop,m=l.state.workSpace.cloneAreaStyle.left-e-T.offsetLeft,p=l.state.workSpace.cloneAreaStyle.top-o-T.offsetTop,f=h*S,g=v.width,x=v.height,w=l.state.workSpace.canvas.width;if(m+y>0&&m<g&&p+f>0&&p<x){if(t.clientX-y/2>w+r||t.clientX+y/2<r)return l.commit(n.gzP,{show:!1}),t.stopPropagation(),document.onmousemove=null,void(document.onmouseup=null);(0,c.$P)({permissionType:"text"})||(0,c.DB)({permissionType:"text"}),p/=d,m/=d,l.commit(n.eaZ,{hasTempText:!0,textTop:p,textLeft:m}),i.name=i.textStr;let e=JSON.parse(JSON.stringify(i));e.style.width=k;let o=new s.Z(e);localStorage.getItem("textDirection")&&(o.innerTextStyle.direction=localStorage.getItem("textDirection")),(async()=>{let{item:t}=await l.dispatch(n.VOZ,{item:o,selectItem:!0}),i={left:m,top:p};await l.dispatch(n.ld$,{item:t,position:i}),l.commit(n.u_l,{item:t,textState:!0}),e.isSystemFont?(await l.dispatch(n.qd3,{item:t}),await l.dispatch(n.FKI,{item:t}).catch((()=>{}))):await l.dispatch(n.fhz,{item:t}),l.commit(n.u_l,{item:t,textState:!1}),l.commit(n.ahn,{item:t}),l.commit(n.gzP,{show:!1,canUndo:!0}),a.Q.$emit(a.Y.TIMELINE_CREATE_ANIME,{isSeekToCurrentSlider:!0}),l.commit(n.t3z,{type:"setting"})})()}else l.commit(n.gzP,{show:!1});t.stopPropagation(),document.onmousemove=null,document.onmouseup=null}}}},components:{IconText:i(28075).default}},h=(0,i(1001).Z)(d,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"dragTextToAdd",rawName:"v-dragTextToAdd",value:{item:t.headlineItem,width:t.isENLang?290:168,height:28,textType:"headLine",stopDrag:!t.isFlipPro},expression:"{\n    item: headlineItem,\n    width: isENLang ? 290 : 168,\n    height: 28,\n    textType: 'headLine',\n    stopDrag: !isFlipPro,\n  }"}],staticClass:"MenuForText",class:{selected:"text"===this.$store.state.menuPanel.selectedMenu,blurMenu:!t.canClick,menuItem:!t.isMore,menuItemMore:t.isMore},attrs:{name:"left_h5_text_menu","data-fn-search":"menu_text",title:t.isOtherLang?t.$t("menu.text"):"","data-intercom-target":"text"},on:{click:t.addText}},[e("el-icon",{attrs:{size:16}},[e("IconText")],1),e("span",{directives:[{name:"t",rawName:"v-t",value:"menu.text",expression:"'menu.text'"}]})],1)}),[],!1,null,"486dccd4",null).exports}}]);