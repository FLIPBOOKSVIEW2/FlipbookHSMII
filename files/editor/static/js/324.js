self.onmessage=function(e){let t=[];const{pages:s,newPageNoList:i,newAsyncItemList:n,currentIndex:o,isDoubleEdit:l,tempWidth:r}=e.data;if(i&&i.length||n&&n.length){const e=["style","innerTextStyle","isAllBold","isAllItalic","isAllUndeline","strikeThrough","startPageNumber","isCustomPage","startPage","copyPagesArray","position","rotate","filter","rotateY","rotateX","isLocked","customPage","isUploadedFont","uploadFontUrl","uploadedFontFileName","isNewFile"];s.forEach((async(t,s)=>{let a=[...t.items];t.items.filter((e=>"pagination"===e.type||e.asyncLot)).forEach((g=>{let m=i.find((e=>e.lot===g.lot)),y=n.length&&n.find((e=>e.asyncLot===g.asyncLot));if(m){2!==m.isCustomPage||m.customPage||(m.isCustomPage=1),e.forEach((e=>{g[e]=c(m[e],!0),l&&g.isAsyncRight&&(g.style.left=parseFloat(m.style.left)+r+"px")}));let i=u(s,l,g);g.isHidden=d(m,i,o);const n=parseInt(s)-(2===g.isCustomPage?g.copyPagesArray[0]:0)+parseInt(g.startPageNumber||0===g.startPageNumber?g.startPageNumber:1);g.value=n;let y=t.items.findIndex((e=>e.id===g.id));a[y]=g}if(y&&s!==o){2===y.isCustomPage&&!y.customPage&&y.asyncArray&&(y.isCustomPage=1);let e=t.items.findIndex((e=>e.id===g.id)),i=c(y,!0);if("transShape"===g.type){let e=["strokeColor","fillColor","fillColor2"];for(let t=0;t<e.length;t++)tempAsyncItemObj[e[t]].indexOf("url")>-1&&(i[e[t]]=`url(#gradient${g.id}${t+1})`,i.gradientColorList[t].id=`gradient${g.id}${t+1}`)}i.id=g.id,i.CID=g.CID,i.isAsyncRight=g.isAsyncRight,i.isCrossPageItem=g.isCrossPageItem,i.crossIndex=g.crossIndex,i.isCloseAsyncItem=g.isCloseAsyncItem;let n=u(s,l,i);i.isHidden=y.isCloseAsyncItem?g.isHidden:d(y,n,o,l),l&&i.isAsyncRight&&(i.style.left=parseFloat(y.style.left)+r+"px"),a[e]=i}t.items=c(a,!0)}))}))}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){if(t=!!t,function(e){return Array.isArray(e)||null!==e&&"object"==typeof e&&e.length>=0&&e.length%1==0}(e)){const s=e.length,i=s<1024?new Array(s):[];for(let n=0;n<s;++n)i[n]=t?c(e[n],t):e[n];return i}if(function(e){return"[object Object]"===toString.call(e)}(e)){const s={};for(const i in e)a(e,i)&&(s[i]=t?c(e[i],t):e[i]);return s}return e}function u(e,t,s){let i=e;return t&&0!==i&&(i=2*i-(s.isAsyncRight?0:1)),i}function d(e,t,s,i){let n=s?2*s-1:0,o=!1,l="pagination"===e.type?e.copyPagesArray:e.asyncArray;return o=i?2===e.isCustomPage&&l.includes(t)&&l.includes(n)||1===e.isCustomPage?e.isHidden:!(2===e.isCustomPage&&l.includes(Number(t))&&!l.includes(Number(n))):2===e.isCustomPage&&l.includes(t)&&l.includes(s)||1===e.isCustomPage?e.isHidden:!(2===e.isCustomPage&&l.includes(Number(t))&&!l.includes(Number(s))),o}t=s,self.postMessage(t),t=null,self.close()};