"use strict";(self.webpackChunkeditor_cli=self.webpackChunkeditor_cli||[]).push([[2667],{72667:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var i=r(18023),s=r(11201),o=r(80597),n=r(77170),a=r(2759),c=r(12915),l=r(7631),u=r(43569),m={name:"PropsForFrames",data(){return{isResetting:!1}},mixins:[n.u,c.S],computed:{framesClipIndex:function(){return this.$store.state.workSpace.framesClipIndex},item:function(){return this.$store.getters.currentSelectedItem},isCustomFrames(){return!this.$store.getters.currentSelectedItem.fileName},imageList(){return this.item.imageList},showImageSize(){return!this.$store.getters.isMulti&&1===this.imageList.length},isYZPro(){return this.$store.getters.isYZPro},isMulti:function(){return this.$store.getters.isMulti},isShowReplace(){const e=this.item.imageList[-1===this.framesClipIndex?0:this.framesClipIndex];return!this.isMulti&&this.showReplaceBtn&&e.url}},methods:{undo:function(){this.$store.commit(i.N23,{canUndo:!0})},debounceResetColor:(0,u.Z)((function(){this.resetColor()}),800),async resetColor(){if(!this.isResetting){this.isResetting=!0;try{const e=await fetch(this.item.jsonUrl),t=(await e.json()).fillColor;t&&t.forEach(((e,t)=>{this.setColor({value:e,index:t})})),this.undo()}catch(e){}finally{this.isResetting=!1}}},cropImage:function(){let e=this.item;this.$store.commit(i.g5N,{item:e,deg:0,framesRotate:e.rotate,rotateX:e.rotateX,rotateY:e.rotateY}),this.$store.state.workSpace.cropMode.isEnable=!0},setColor:function({index:e,value:t}){this.$store.commit(i.AXo,{index:e,color:t})}},components:{PropGroup:s.default,ColorPickerV2:o.default,CropIcon:()=>r.e(6746).then(r.bind(r,76746)),ResourceFavorite:a.Z,UploadImageToReplace:l.Z,InfoTipsIcon:()=>r.e(3352).then(r.bind(r,83352))}},h=(0,r(1001).Z)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"PropsForFrames"},[e.isShowFavorite&&e.showReplaceBtn?t("PropGroup",[e.isShowFavorite?t("ResourceFavorite",{attrs:{isShowFavorite:!e.isCustomFrames}}):e._e()],1):e._e(),e.showImageSize&&e.isYZPro?t("PropGroup",[t("p",{staticClass:"img-size"},[e._v(" "+e._s(this.$t("imgSize2023_05_16.text1",{width:this.imageList[0].imageInfor.originalW,height:this.imageList[0].imageInfor.originalH}))+" ")])]):e._e(),e.isShowReplace?t("PropGroup",[t("ResourceReplace",{attrs:{text:e.$t("PropsForFrames.ReplaceImage")}}),t("UploadImageToReplace")],1):e._e(),e.item.hasFillSvg?t("PropGroup",{scopedSlots:e._u([{key:"title",fn:function(){return[t("el-row",{staticStyle:{width:"100%"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[t("el-row",[t("span",[e._v(e._s(e.$t("rightPanel.chart_colorSetting")))])]),[t("div",{staticClass:"btn btn-white resetBtn",on:{click:e.debounceResetColor}},[e._v(" "+e._s(e.$t("PropsForSvg_vue.text3"))+" ")])]],2)]},proxy:!0}],null,!1,2568856988)},[t("el-row",{staticClass:"colorArea",attrs:{type:"flex"}},e._l(e.item.fillColor,(function(r,i){return t("div",{key:i,staticClass:"colorBox"},[t("ColorPickerV2",{attrs:{color:r,changeCallback:({value:t})=>{e.setColor({value:t,index:i})}}})],1)})),0)],1):e._e(),-1!==e.framesClipIndex&&-1===e.$store.state.workSpace.currentSelectedGroupItemIndex?t("PropGroup",{attrs:{title:"rightPanel.frames_imgSetting"},scopedSlots:e._u([{key:"title",fn:function(){return[t("el-tooltip",{attrs:{placement:"top","open-delay":800,content:e.$t("PropsForFrames.selectImageCrop")}},[t("el-icon",{staticStyle:{"font-size":"12px","margin-left":"3px",color:"#bbb"}},[t("InfoTipsIcon",{tag:"component"})],1)],1)]},proxy:!0}],null,!1,3175237546)},[t("div",{staticClass:"editor_v2_white_btn",on:{click:function(t){return t.stopPropagation(),e.cropImage.apply(null,arguments)}}},[t("el-icon",{attrs:{size:16}},[t("CropIcon",{tag:"component"})],1),t("span",[e._v(e._s(e.$t("rightPanel.image_cropImage")))])],1)]):e._e()],1)}),[],!1,null,"efa261a0",null),p=h.exports},2759:function(e,t,r){r.d(t,{Z:function(){return n}});var i=r(18023),s=r(66546),o={name:"",props:{isShowFavorite:{type:Boolean,default:!0}},data(){return{msg:null}},computed:{pathAnime:function(){return this.$store.state.timeline.pathAnime},pathItemSelectedIndex:function(){return this.pathAnime.pathItemSelectedIndex},currentSelectedGroupItemIndex:function(){return this.$store.state.workSpace.currentSelectedGroupItemIndex},currentSelectedItem:function(){return-1!==this.currentSelectedGroupItemIndex?this.$store.getters.currentPageItems[this.currentSelectedItemIndex]:this.item},item:function(){return-1!==this.pathItemSelectedIndex?this.$store.getters.currentSelectedPathItem:this.$store.getters.currentSelectedItem},currentSelectedItemIndex:function(){return this.$store.state.workSpace.currentSelectedItemIndex},currentPageItems:{get:function(){return this.$store.getters.currentPageItems},set:function(e){this.$store.getters.currentPageItems=e}}},mounted(){this.getFavorite()},methods:{searchBeLike:function(){this.$store.commit(i.$8l,{menu:"material"}),this.$store.commit(i.xZf,{firstType:"material",secType:"resource"}),setTimeout((()=>{s.Q.$emit(s.Y.SEARCH_SIMILARITY,this.item.name)}),500)},getFavorite:function(){if(-1!==this.currentSelectedItemIndex&&this.currentPageItems[this.currentSelectedItemIndex].resourceId){let e={id:this.currentPageItems[this.currentSelectedItemIndex].resourceId};this.$http.post(`${this.$store.getters.host}/interface/resource/getResourceFavoriteStatus.php`,e).then((e=>{e.data.status+""=="1"&&this.$set(this.currentPageItems[this.currentSelectedItemIndex],"isFavorite",e.data.data.isFavorite+"")})).catch((e=>{}))}},collection:function(){const e=this.getParams();this.$http.post(`${this.$store.getters.host}/interface/resource/favoriteResource.php`,e).then((e=>{let t=e.data;1===parseInt(t.status)?(this.msg&&this.msg.close(),this.currentSelectedItem.resourceId=t.resourceId,this.currentSelectedItem.isFavorite="0"===this.currentSelectedItem.isFavorite?"1":"0",this.msg=this.$message({dangerouslyUseHTMLString:!0,showClose:!0,message:"1"===this.item.isFavorite?"素材收藏成功，可到<span style='cursor:pointer;text-decoration: underline;'>【素材库-收藏素材】</span>中查看！":"取消收藏成功！",type:"success",duration:5e3}),"1"===this.item.isFavorite&&(this.msg.$el.querySelector("span").onclick=()=>{this.$store.commit(i.$8l,{menu:"material"}),this.$store.commit(i.xZf,{firstType:"material",secType:"like"})})):2===parseInt(t.status)?this.$message.error("该素材已存在我的收藏中！"):this.$message.error(t.msg)}))},getParams(){let e;switch(this.item.type){case"image":e=this.item.url;break;case"effect":case"frames":e=this.item.jsonUrl;break;case"svg":e=this.item.svgUrl}const t={png:[7,8],apng:[7,8],jpg:[1,20],jpeg:[1,20],gif:[1,20],svg:[4,101],json:[13,117]};let r,i,s=this.item.fileName.split("."),o=s.length>0?s[s.length-1].toLowerCase():"";return t[o]&&([r,i]=t[o]),Object.assign({},{url:e,width:parseFloat(this.item.style.width),height:parseFloat(this.item.style.height),action:"0"===this.item.isFavorite?"1":"0",firstId:this.item.firstId?this.item.firstId:r,secondId:this.item.secondId?this.item.secondId:i,isCommercial:this.item.isCommercial,fileType:this.item.type},this.item.range?{rangeCode:this.item.range}:{})}},components:{ResembleIcon:()=>r.e(888).then(r.bind(r,70888)),FavoriteIcon:()=>r.e(7432).then(r.bind(r,47432)),FavoriteNotIcon:()=>r.e(4830).then(r.bind(r,44830))}},n=(0,r(1001).Z)(o,(function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"favorite_box",attrs:{type:"flex",align:"middle"}},[t("div",{staticClass:"editor_v2_white_btn",attrs:{title:"Ctrl+F：搜索相似，Ctrl+B：精准搜索"},on:{click:e.searchBeLike}},[t("el-icon",{attrs:{size:16}},[t("ResembleIcon",{tag:"component"})],1),e._v(" 搜索相似 ")],1),e.isShowFavorite?[t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.isFavorite+""=="0"&&!e.item.isSprite,expression:"item.isFavorite + '' === '0' && !item.isSprite"}],staticClass:"editor_v2_white_btn",on:{click:e.collection}},[t("el-icon",{attrs:{size:16}},[t("FavoriteIcon",{tag:"component"})],1),e._v(" 收藏 ")],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.isFavorite+""=="1",expression:"item.isFavorite + '' === '1'"}],staticClass:"editor_v2_white_btn",on:{click:e.collection}},[t("el-icon",{attrs:{size:16}},[t("FavoriteNotIcon",{tag:"component"})],1),e._v(" 取消收藏 ")],1)]:e._e()],2)}),[],!1,null,"30602f7d",null).exports},94101:function(e,t,r){r.d(t,{Z:function(){return a}});var i=r(18023),s=r(76748),o={name:"ResourceReplace",props:{text:{type:String,default:s.ag.t("propsForEffect.changeMaterial")}},data(){return{}},computed:{currentSelectedItem:function(){return this.$store.getters.currentSelectedItem}},methods:{intoReplaceMode(){if(this.currentSelectedItem.isAsyncItem)return this.$message.warning(this.$t("asyncItem_20240318.text4"));this.$store.commit(i.Ewg,{isPreview:!1}),this.$store.commit(i.eKS,{isShow:!0})}},components:{ReplaceIcon:()=>r.e(4210).then(r.bind(r,74210))}},n=(0,r(1001).Z)(o,(function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"editor_v2_white_btn",nativeOn:{click:function(t){return e.intoReplaceMode.apply(null,arguments)}}},[t("el-icon",{staticStyle:{"margin-right":"5px"},attrs:{size:14}},[t("ReplaceIcon")],1),e._v(" "+e._s(e.text)+" ")],1)}),[],!1,null,"cc0535a6",null),a=n.exports},7631:function(e,t,r){r.d(t,{Z:function(){return I}});var i=r(92301),s=r(2137),o=(r(28206),r(8021)),n=r(18023),a=r(87632),c=r(66546),l=r(89951),u=r(24118),m=r(23407),h=r(57144),p=r(73385),d=r(56084),g={name:"UploadImageToReplace",data(){return{}},computed:{imageUploadOpts(){return new s.C({multiple:!1,accept:this.acceptImageType.map((e=>`.${e}`)).join(",")})},acceptImageType:function(){return this.isFlipPro?[...this.$store.getters.acceptImageType,"svg"]:this.$store.getters.acceptImageType},isMulti:function(){return this.$store.getters.isMulti},isFlipPro:function(){return this.$store.getters.isFlipPro},multiSettingCount(){return this.$store.getters.multiSettingCount},currentPageItems:function(){return this.$store.getters.currentPageItems},currentSelectedItem(){return this.$store.getters.currentSelectedItem},currentSelectedItemIndex:function(){return this.$store.state.workSpace.currentSelectedItemIndex},currentSelectedGroupItemIndex:function(){return this.$store.state.workSpace.currentSelectedGroupItemIndex}},methods:{replaceImageToSvg(e){this.$store.commit(n.CjF);let{url:t,fileName:r}=e;this.isMulti?this.multiSettingCount.forEach((r=>{const i=this.currentPageItems[r];"group"===i.type?this.replaceGroupImagesToSvg(i,e,t):"image"===i.type&&this.replaceCurImageItemToSvg(i,e,t,r)})):-1===this.currentSelectedGroupItemIndex?this.replaceCurImageItemToSvg(this.currentSelectedItem,e,t,this.currentSelectedItemIndex):this.replaceImageToSvgInGroup({resource:e,imageUrl:t,groupItem:this.currentSelectedItem,groupIndex:this.currentSelectedGroupItemIndex,group:this.currentPageItems[this.currentSelectedItemIndex],isMulti:!1}),c.Q.$emit(c.Y.TIMELINE_CREATE_ANIME,{isSeekToCurrentSlider:!0}),this.$store.commit(n.N23,{canUndo:!0}),this.$store.commit(n.jQC,{fileName:r})},replaceImage(e){this.$store.commit(n.CjF);let{url:t,fileName:r,svgUrl:i}=e;-1===t.indexOf(".svg")&&!i||!this.isFlipPro?(-1===t.indexOf("x-oss-process")&&(t=~t.indexOf(".gif")?`${t}${this.$store.getters.ossGifImgSuffix}`:`${t}${this.$store.getters.ossImgSuffix}`),this.isMulti?this.multiSettingCount.forEach((r=>{const i=this.currentPageItems[r];"group"===i.type?this.replaceGroupImages(i,e,t):"image"===i.type&&this.replaceCurImageItem(i,e,t,r)})):-1===this.currentSelectedGroupItemIndex?this.replaceCurImageItem(this.currentSelectedItem,e,t,this.currentSelectedItemIndex):this.replaceImageInGroup({resource:e,imageUrl:t,groupItem:this.currentSelectedItem,groupIndex:this.currentSelectedGroupItemIndex,group:this.currentPageItems[this.currentSelectedItemIndex]}),c.Q.$emit(c.Y.TIMELINE_CREATE_ANIME,{isSeekToCurrentSlider:!0}),this.$store.commit(n.N23,{canUndo:!0}),this.$store.commit(n.jQC,{fileName:r})):this.replaceImageToSvg(e)},async replaceCurImageItemToSvg(e,t,r="",i){const s=(0,m.p)(t.svgCode),a=h.Z.getOriginSvgColorList(s).newColorList,c=new l.KP({svgCode:t.svgCode,originColorList:a,svgUrl:r,name:t.name,fileName:u.Z.getPathFilename(r),isUpload:!0,isNewFile:!0});if("group"===e.type)this.replaceGroupImagesToSvg(e,t,r);else{const t=(0,o.P)(c,e);this.$store.commit(n.loC,{items:[t],spliceIndex:i})}},replaceCurImageItem(e,t,r="",s){if("group"===e.type)this.replaceGroupImages(e,t,r);else{let{width:a,height:c,fileName:l}=t;const u=new i.Z({originalWidth:a,originalHeight:c,url:r,isUpload:!0,fileName:l,isCreatedByYZTemplate:e.isCreatedByYZTemplate});if("frames"===e.type)return void(0,p.Y)(e,u);const m=(0,o.P)(u,e);this.$store.commit(n.loC,{items:[m],spliceIndex:s})}},async asyncForEach(e,t){for(let[r,i]of e.entries())await t(i,r)},async replaceGroupImagesToSvg(e,t,r){await this.asyncForEach(e.items,(async(i,s)=>{"image"!==i.type&&"svg"!==i.type||await this.replaceImageToSvgInGroup({resource:t,imageUrl:r,groupItem:i,groupIndex:s,group:e,isMulti:!0})})),this.$store.commit(n.V$Q,{}),this.$store.commit(n.jMO)},replaceGroupImages(e,t,r){e.items.forEach(((i,s)=>{"image"===i.type&&this.replaceImageInGroup({resource:t,imageUrl:r,groupItem:i,groupIndex:s,group:e})}))},async replaceImageToSvgInGroup({resource:e,imageUrl:t="",groupItem:r,groupIndex:i=0,group:s,isMulti:a}){const c=(0,m.p)(e.svgCode),p=h.Z.getOriginSvgColorList(c).newColorList,d=new l.KP({svgCode:e.svgCode,originColorList:p,svgUrl:t,name:e.name,fileName:u.Z.getPathFilename(t),isUpload:!0,isNewFile:!0}),g=(0,o.P)(d,r);s.items.splice(i,1,g),a||(this.$store.commit(n.V$Q,{}),this.$store.commit(n.jMO))},replaceImageInGroup({resource:e,imageUrl:t="",groupItem:r,groupIndex:s=0,group:n}){let{width:a,height:c,fileName:l}=e;const u=new i.Z({originalWidth:a,originalHeight:c,url:t,isUpload:!0,fileName:l,isCreatedByYZTemplate:r.isCreatedByYZTemplate});if("frames"===r.type)return void(0,p.Y)(r,u);const m=(0,o.P)(u,r);n.items.splice(s,1,m)},replaceFastAddPopupImg:function(e,t,r){if(!this.isYZPro)return;const i=e.type,s=e.actionList;["image","svg"].includes(i)&&0!==s.length&&s.forEach((e=>{const i=e.popupImg.imgList;i&&i.length>0&&i.forEach((e=>{e.isFastAdd&&(e.url=t,e.fileName=r,e.isNewFile=!0)}))}))}},components:{MutiUploadList:a.default,SelectImageIcon:d.default}},I=(0,r(1001).Z)(g,(function(){var e=this,t=e._self._c;return t("MutiUploadList",{ref:"uploadButton",attrs:{"upload-title":e.$t("rightPanel.image_changeImage"),"file-dialog-opts":e.imageUploadOpts},on:{"upload-success":e.replaceImage}},[t("template",{slot:"title"},[t("el-icon",{staticStyle:{"margin-right":"5px"},attrs:{size:14}},[t("SelectImageIcon")],1),t("span",[e._v(e._s(e.$t("rightPanel.image_changeImage")))])],1)],2)}),[],!1,null,null,null).exports},56084:function(e,t,r){r.r(t),r.d(t,{default:function(){return i}});var i=(0,r(1001).Z)({},(function(){var e=this._self._c;return e("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("g",{attrs:{"clip-path":"url(#clip0_14693_18258)"}},[e("path",{attrs:{d:"M3 3H11C12.1046 3 13 3.89543 13 5V8L10 6L4 11",stroke:"#333333","stroke-width":"2","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M1 5V10.5C1 10.7761 1.22386 11 1.5 11H10",stroke:"#333333","stroke-width":"2"}}),e("path",{attrs:{d:"M4 4V0.608402C4 0.0674589 3.34598 -0.203447 2.96347 0.179057L0.179057 2.96347C-0.203447 3.34598 0.067458 4 0.608401 4H4Z",fill:"#333333"}}),e("path",{attrs:{d:"M10 10V13.3916C10 13.9325 10.654 14.2034 11.0365 13.8209L13.8209 11.0365C14.2034 10.654 13.9325 10 13.3916 10H10Z",fill:"#333333"}}),e("circle",{attrs:{cx:"4",cy:"6",r:"1",fill:"#333333"}})]),e("defs",[e("clipPath",{attrs:{id:"clip0_14693_18258"}},[e("rect",{attrs:{width:"14",height:"14",fill:"white"}})])])])}),[],!1,null,null,null).exports},77170:function(e,t,r){r.d(t,{u:function(){return i}});const i={computed:{currentPageItems:{get:function(){return this.$store.getters.currentPageItems},set:function(e){this.$store.getters.currentPageItems=e}},currentSelectedItemIndex:function(){return this.$store.state.workSpace.currentSelectedItemIndex},item:function(){return-1!==this.pathItemSelectedIndex?this.$store.getters.currentSelectedPathItem:this.$store.getters.currentSelectedItem},currentSelectedItem:function(){return-1!==this.currentSelectedGroupItemIndex?this.$store.getters.currentPageItems[this.currentSelectedItemIndex]:this.item},pathAnime:function(){return this.$store.state.timeline.pathAnime},pathItemSelectedIndex:function(){return this.pathAnime.pathItemSelectedIndex},currentSelectedGroupItemIndex:function(){return this.$store.state.workSpace.currentSelectedGroupItemIndex},isXZPro:function(){return this.$store.getters.isXZPro},isShowFavorite(){return!!this.isXZPro&&(-1!==this.currentSelectedItemIndex&&(!this.item.isVisualChina&&(this.item.hasOwnProperty("resourceId")?!this.item.userMateral:(this.$set(this.currentPageItems[this.currentSelectedItemIndex],"isFavorite","0"),!0))))}}}},12915:function(e,t,r){r.d(t,{S:function(){return c}});var i=r(18023),s=r(94101),o={name:"ResourceTopGroup",data(){return{}},computed:{pathAnime:function(){return this.$store.state.timeline.pathAnime},pathItemSelectedIndex:function(){return this.pathAnime.pathItemSelectedIndex},item:function(){return-1!==this.pathItemSelectedIndex?this.$store.getters.currentSelectedPathItem:this.$store.getters.currentSelectedItem},isXZPro:function(){return this.$store.getters.isXZPro},isMulti:function(){return this.$store.getters.isMulti}},methods:{intoReplaceMode(){this.$store.commit(i.Ewg,{isPreview:!1}),this.$store.commit(i.eKS,{isShow:!0})},searchBeLike:function(){this.$store.commit(i.$8l,{menu:"material"}),this.isShowSearchPanel=!0,setTimeout((()=>{eventBus.$emit(busType.SEARCH_SIMILARITY,this.item.name)}),500)}},components:{PropGroup:r(11201).default}},n=(0,r(1001).Z)(o,(function(){var e=this,t=e._self._c;return t("PropGroup",{attrs:{itemId:e.item.id}},[e.isMulti?e._e():[t("el-row",{staticClass:"editor_v2_white_btn",nativeOn:{click:function(t){return e.intoReplaceMode.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("propsForEffect.changeMaterial"))+" ")]),e.isXZPro?t("el-row",{staticClass:"editor_v2_white_btn",nativeOn:{click:function(t){return e.searchBeLike.apply(null,arguments)}}},[e._v(" 搜索相似 ")]):e._e(),e.isXZPro?t("el-row",{staticClass:"editor_v2_white_btn",nativeOn:{click:function(t){return e.searchBeLike.apply(null,arguments)}}},[e._v(" 收藏 ")]):e._e()],e._t("default")],2)}),[],!1,null,"5e160046",null),a=n.exports;const c={components:{ResourceReplace:s.Z,ResourceTopGroup:a},replaceRes:function(){this.$store.commit(i.Ewg,{isPreview:!1}),this.$store.commit(i.eKS,{isShow:!0})},computed:{currentSelectedGroupItemIndex:function(){return this.$store.state.workSpace.currentSelectedGroupItemIndex},isEditingPath:function(){return this.$store.state.timeline.pathAnime.isEditingPath},showReplaceBtn:function(){return!(-1!==this.currentSelectedGroupItemIndex&&!this.isEditingPath)},isXZPro:function(){return this.$store.getters.isXZPro}}}}}]);